---
title: "ç»Ÿè®¡å­¦-åŸºäºRè¯¾åè§£ç­”"
author: "æ²³åŒ—ç»è´¸å¤§å­¦17çº§ç»Ÿè®¡å­¦ä¸“ä¸šæ‰€æœ‰åŒå­¦,å…¶ä¸­ä¿®è®¢ä¸ºæ€ªåŠ›å¥¶é…ªã€å­è¡¿,ç½‘ç»œæŠ€æœ¯ä¸ºå¼¯ä»”é©¬å¤´ã€åå››è¡Œè¯—"
date: "2020å¹´2æœˆ"
site: bookdown::bookdown_site
output: bookdown::gitbook
description: "è¿™æ˜¯ç”¨Rçš„bookdownåŠŸèƒ½åˆ¶ä½œä¸­æ–‡å›¾ä¹¦çš„æ¨¡æ¿ï¼Œè¾“å‡ºæ ¼å¼ä¸ºbookdown::gitbookå’Œbookdown::pdf_book."
documentclass: book
biblio-style: apalike
# bibliography: [mybib.bib]
link-citations: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r}
#install.packages(c("repmis","plotrix","vioplot","fmsb","aplpack","DescTools","TeachingDemos","agricolae","pastecs","BSDA","car","psych",lm.beta","forecast","R.cache","R.methodsS3","R.oo","R.utils"))
```
Reading a Rdata file from github
```{r}
library(repmis)
```
# ç¬¬ä¸€ç« 
## ä¸‹é¢æ˜¯æŒ‰æ”¶å…¥äº”ç­‰åˆ’åˆ†çš„æˆ‘å›½å†œæ‘å¹³å‡æ”¶å…¥æ•°æ®ï¼ˆå•ä½ï¼šå…ƒï¼‰
### åœ¨Rä¸­å½•å…¥ä¸Šè¡¨æ•°æ®ï¼Œå¹¶å­˜ä¸ºRæ ¼å¼
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch1/exercise1_1.RData?raw=True")
head(exercise1_1,10)
```

### å°†ä¸Šè¿°æ•°æ®æ¡†è½¬æ¢ä¸ºçŸ©é˜µ
```{r}
aver_income=as.matrix(exercise1_1[,2:6])
aver_income
rownames(aver_income)=exercise1_1[,1]
aver_income
colnames(aver_income)=gsub("X","",colnames(aver_income))
aver_income
```

## ä¸‹è¡¨æ˜¯2014å¹´æˆ‘å›½å„åœ°åŒºçš„åœ°åŒºç”Ÿäº§æ€»å€¼æ•°æ®
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch1/exercise1_2.RData?raw=True")
head(exercise1_2,10)
```
### æŒ‰åœ°åŒºç”Ÿäº§æ€»å€¼å¤šå°‘è¿›è¡Œå‡åºå’Œé™åºæ’åº
```{r}
gdp2014=exercise1_2
gdp2014_increasing=gdp2014[order(gdp2014$"åœ°åŒºç”Ÿäº§æ€»å€¼"),]
gdp2014_decreasing=gdp2014[order(-gdp2014$"åœ°åŒºç”Ÿäº§æ€»å€¼"),]
head(gdp2014_increasing,10)
head(gdp2014_decreasing,10)
```
### å°†åœ°åŒºç”Ÿäº§æ€»å€¼é‡æ–°å‘½åä¸ºGDP,å¹¶å­˜ä¸ºRæ•°æ®æ ¼å¼
```{r}
library(repmis)
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch1/exercise1_2.RData?raw=True")
exercise112=c(exercise1_2)
exercise112
```
### åˆ†åˆ«é‡‡ç”¨æœ‰æ”¾å›æŠ½æ ·å’Œæ— æ”¾å›æŠ½æ ·ä¸¤ç§æ–¹å¼å„éšæœºæŠ½å–6ä¸ªåœ°åŒºä½œä¸ºæ ·æœ¬
```{r}
sample(exercise1_2$åœ°åŒº,6,replace = FALSE)
sample(exercise1_2$åœ°åŒº,6,replace = TRUE)
```
### åˆ†åˆ«ç­›é€‰å‡ºåœ°åŒºç”Ÿäº§æ€»å€¼å°äº2ä¸‡äº¿å…ƒå’Œå¤§äº5ä¸‡äº¿å…ƒçš„åœ°åŒº
```{r}
sample(exercise1_2$åœ°åŒº[exercise1_2$GDP<20000])
sample(exercise1_2$åœ°åŒº[exercise1_2$GDP>50000])
```
## ç”¨Rç”Ÿäº§20ä¸ªæ ‡å‡†æ­£æ€åˆ†å¸ƒéšæœºæ•°ï¼Œå°†å…¶ç»„ç»‡æˆ4*5å’Œ5*4çš„çŸ©é˜µ
```{r}
rnorm(20)
y<-rnorm(20)
matrix1_3=matrix(y,nrow=4,ncol=5)
matrix1_3
matrix1_4=matrix(y,nrow=5,ncol=4)
matrix1_4
```
# ç¬¬äºŒç«  æ•°æ®çš„å¯è§†åŒ–
## ä¸ºäº†äº†è§£æ¶ˆè´¹è€…å¯¹ä¸åŒè¡Œä¸šçš„æ»¡æ„åº¦ï¼Œéšæœºè°ƒæŸ¥120ä¸ªæ¶ˆè´¹è€…ï¼Œå¾—åˆ°å¦‚ä¸‹æ•°æ®
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch2/exercise2_1.RData?raw=True")
head(exercise2_1,10)
```
### ç”Ÿæˆç®€å•é¢‘æ•°åˆ†å¸ƒè¡¨ã€äºŒç»´åˆ—è”è¡¨å’Œä¸‰ç»´åˆ—è”è¡¨
```{r}
summary(exercise2_1)
```

### ç”Ÿæˆè¡Œä¸šå’Œæ€§åˆ«çš„äºŒç»´åˆ—è”è¡¨
```{r}
table1=table(exercise2_1$"è¡Œä¸š",exercise2_1$"æ€§åˆ«")
addmargins(table1)
```

### ç”Ÿæˆè¡Œä¸šå’Œæ»¡æ„åº¦çš„äºŒç»´åˆ—è”è¡¨
```{r}
table2=table(exercise2_1$"è¡Œä¸š",exercise2_1$"æ»¡æ„åº¦")
addmargins(table2)
```

### ç”Ÿæˆæ€§åˆ«å’Œæ»¡æ„åº¦çš„äºŒç»´åˆ—è”è¡¨
```{r}
table3=table(exercise2_1$"æ€§åˆ«",exercise2_1$"æ»¡æ„åº¦")
addmargins(table3)
```

### ç”Ÿæˆä¸‰ç»´åˆ—è”è¡¨
```{r}
table4=ftable(exercise2_1)
table4
```

### åˆ†åˆ«ç»˜åˆ¶å…³äºè¡Œä¸šã€æ€§åˆ«å’Œæ»¡æ„åº¦çš„æ¡å½¢å›¾
```{r}
load("c:/exercise/ch2/exercise2_1.RData")
count1<-table(exercise2_1$è¡Œä¸š)
count2<-table(exercise2_1$æ€§åˆ«)
count3<-table(exercise2_1$æ»¡æ„åº¦)
par(mfrow=c(1,3),pin=c(1.2,1.2),cex=0.7,cex.main=0.8)
bar<-barplot(count1,xlab="é¢‘æ•°",ylab="è¡Œä¸š",horiz=TRUE,xlim=c(0,1.2*max(count1)),main="(a)æ°´å¹³æ¡å½¢å›¾",col=2:5)
text(bar,count1,labels=count1,pos=4,adj=c(0,0.5))
bar<-barplot(count2,xlab="æ€§åˆ«",ylab="é¢‘æ•°",col=c("gray40","gray80"),ylim=c(0,1.2*max(count2)),main="(b)å‚ç›´æ¡å½¢å›¾")
 text(bar,count2,labels=count2,pos=3,col=2)
 bar<-barplot(count3,xlab="æ»¡æ„åº¦",ylab="é¢‘æ•°",ylim=c(0,1.1*max(count3)),col=2:3,main="(c)å‚ç›´æ¡å½¢å›¾")
text(bar,count3/2,labels=count3,pos=3,col=4)
```

### ç»˜åˆ¶ä¸åŒè¡Œä¸šæ»¡æ„åº¦äººæ•°çš„å¸•ç´¯æ‰˜å›¾
```{r}
count1=table(exercise2_1$"è¡Œä¸š")
par(pin=c(3,2),cex=0.8)
x=sort(count1,decreasing=T)
bar<-barplot(x,xlab="è¡Œä¸š",ylab="é¢‘æ•°",col=rainbow(4),ylim=c(0,1.2*max(count1)))
text(bar,x,labels=x,pos=3,col=1)
y<-cumsum(x)/sum(x)
par(new=T)
plot(y,type="b",lwd=1.5,pch=15,axes=FALSE,xlab='',ylab='',main='')
axis(4)
mtext("ç´¯ç§¯é¢‘ç‡",side=4,line=3,cex=.8)
mtext("ç´¯ç§¯åˆ†å¸ƒæ›²çº¿",line=-2.5,cex=.8,adj=0.75)
```

### å¤å¼æ¡å½¢å›¾---è¡Œä¸šå’Œæ»¡æ„åº¦
```{r}
mytable1=table(exercise2_1$"æ»¡æ„åº¦",exercise2_1$"è¡Œä¸š")
par(pin=c(3,2),cex=0.6)
bar1<-barplot(mytable1,xlab="è¡Œä¸š",ylab="é¢‘æ•°",ylim=c(0,30),col=c("pink","lightblue"),legend=rownames(mytable1),args.legend=list(x=9),,beside=T)
text(bar1,mytable1,labels=mytable1,pos=3,col=1)
```

### å¤å¼æ¡å½¢å›¾---æ€§åˆ«å’Œæ»¡æ„åº¦
```{r,fig.height = 3, fig.width = 4}
mytable2=table(exercise2_1$"æ»¡æ„åº¦",exercise2_1$"æ€§åˆ«")
mytable2
par(mai=c(0.5,0.5,0.1,0.1),cex=0.6)
bar2=barplot(mytable2,xlab="æ€§åˆ«",ylab="é¢‘æ•°",ylim=c(0,45),col=c("lightblue","pink"),legend=rownames(mytable2),args.legend=list(x=4),beside=T)
text(bar2,mytable2,labels=mytable2,pos=3,col=2)
```

### ç»˜åˆ¶é©¬èµ›å…‹å›¾
```{r,fig.height = 3, fig.width = 4}
par(pin=c(2.5,2.5),cex=0.8)
mosaicplot(~æ€§åˆ«+è¡Œä¸š+æ»¡æ„åº¦,data=exercise2_1,color=2:3,main="")
```

### ç»˜åˆ¶é¥¼å›¾å’Œæ‰‡å½¢å›¾å¯¹å„ç±»åˆ«çš„ç™¾åˆ†æ¯”è¿›è¡Œåˆ†æ
```{r, fig.height = 3, fig.width = 4}
count1<-table(exercise2_1$è¡Œä¸š)
name<-names(count1)
percent<-prop.table(count1)*100
label1<-paste(name," ",percent,"%",sep="")
par(pin=c(3,2),pin=c(3,2),cex=0.8)
pie(count1,labels=label1,init.angle=90,radius=1)
```

### ç»˜åˆ¶æ‰‡å½¢å›¾
```{r, fig.height = 3, fig.width = 4}
name<-names(count1)
percent<-count1/sum(count1)*100
percent=round(percent,2)
labs<-paste(name," ",percent,"%",sep="")
library(plotrix)
fan.plot(mar=c(0.7,0.7,0.5,0.3),count1,labels=labs,ticks=10)

```

 åˆ†æï¼šåœ¨è°ƒæŸ¥çš„120ä¸ªæ¶ˆè´¹è€…ä¸­ï¼Œå…¶ä¸­31.67%çš„æ¶ˆè´¹è€…å¯¹ç”µä¿¡è¡Œä¸šæ»¡æ„åº¦åšå‡ºè¯„ä»·ï¼Œä»…15.83%çš„æ¶ˆè´¹è€…å¯¹èˆªç©ºä¸šï¼Œæ»¡æ„åº¦åšå‡ºè¯„ä»·ã€‚ç”µä¿¡è¡Œä¸šå—ä¼—å¹¿ï¼Œè¢«è°ƒæŸ¥è€…åœ¨è¯¥å››ä¸ªè¡Œä¸šä¸­æ¥è§¦æœ€å¤šçš„ä¹Ÿæ˜¯ç”µä¿¡è¡Œä¸šï¼Œæ˜“åšå‡ºè¯„ä»·ï¼Œè€Œèˆªç©ºä¸šä¸å¤§å¤šæ•°å±…æ°‘æ— ç›´æ¥å…³ç³»ï¼Œæ¥è§¦è¾ƒå°‘æ•…è¾ƒä¸å®¹æ˜“åšå‡ºè¯„ä»·ã€‚

## ç¯æ³¡ä½¿ç”¨å¯¿å‘½æµ‹è¯•ï¼ˆå•ä½ï¼šå°æ—¶ï¼‰
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch2/exercise2_2.RData?raw=True")
head(exercise2_2,10)
```

### å°†æ•°æ®åˆ†ä¸º10ç»„ï¼Œç”Ÿæˆé¢‘æ•°åˆ†å¸ƒè¡¨
```{r}
vector2_2<-as.vector(exercise2_2$"ç¯æ³¡å¯¿å‘½")
d=table(cut(vector2_2,breaks=150*(18:28),right=FALSE))
df=data.frame(d)
df
percent=df$Freq/sum(df$Freq)*100
cumsump=cumsum(percent)
mytable=data.frame(d,percent,cumsump)
mytable
```

### ç»˜åˆ¶ç›´æ–¹å›¾
```{R, fig.height = 2, fig.width = 3}
load("C:/exercise/ch2/exercise2_2.RData")
d<-exercise2_2$ç¯æ³¡å¯¿å‘½
par(cex=0.7,mai=c(0.6,0.6,0.2,0.1))
hist(d,ylim=c(0,30),labels=T,xlab="å°æ—¶",ylab="é¢‘æ•°",main="ç¯æ³¡ä½¿ç”¨å¯¿å‘½ç›´æ–¹å›¾")
```

### ç»˜åˆ¶èŒå¶å›¾
```{R}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch2/exercise2_2.RData?raw=True")
stem(exercise2_2$ç¯æ³¡å¯¿å‘½)
```

åˆ†æï¼šç”±èŒå¶å›¾å¯ç›´è§‚çœ‹å‡ºï¼Œç¯æ³¡ä½¿ç”¨å¯¿å‘½æœ€å°å€¼ä¸º2700å°æ—¶ï¼Œæœ€å¤§ä½¿ç”¨å¯¿å‘½ä¸º4169å°æ—¶ã€‚å…¶ä¸­ï¼Œç¯æ³¡ä½¿ç”¨å¯¿å‘½é›†ä¸­åœ¨3500â€”3700å°æ—¶ä¹‹é—´ã€‚

## ä¸‹é¢æ˜¯æˆ‘å›½10ä¸ªåŸå¸‚2006å¹´å„æœˆä»½çš„æ°”æ¸©æ•°æ®

### æŒ‰åŸå¸‚ç»˜åˆ¶ç®±çº¿å›¾å’Œå°æç´å›¾
```{R,fig.height = 3, fig.width = 5}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch2/exercise2_3.RData?raw=True")
par(mai=c(0.5,0.5,0.2,0.2))
boxplot(exercise2_3,col="pink",ylab="æ°”æ¸©",xlab="åŸå¸‚",cex.lab=.8,cex.axis=.7,main="æ°”æ¸©")
library(vioplot)
x1=exercise2_3$"åŒ—äº¬"
x2=exercise2_3$"æ²ˆé˜³"
x3=exercise2_3$"ä¸Šæµ·"
x4=exercise2_3$"å—æ˜Œ"
x5=exercise2_3$"éƒ‘å·"
x6=exercise2_3$"æ­¦æ±‰"
x7=exercise2_3$"å¹¿å·"
x8=exercise2_3$"æµ·å£"
x9=exercise2_3$"é‡åº†"
x10=exercise2_3$"æ˜†æ˜"
vioplot(x1,x2,x3,x4,x5,x6,x7,x8,x9,x10,col="lightblue",names=c("åŒ—äº¬","æ²ˆé˜³","ä¸Šæµ·","å—æ˜Œ","éƒ‘å·","æ­¦æ±‰","å¹¿å·","æµ·å£","é‡åº†","æ˜†æ˜"),pin=c(2,1.5))
```

### æŒ‰åŸå¸‚ç»˜åˆ¶ç‚¹å›¾å’Œæ ¸å¯†åº¦ä¼°è®¡æ›²çº¿
```{r,,fig.height = 3, fig.width = 4}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch2/exercise2_3_1.RData?raw=True")
par(mai=c(.8,.8,.1,.1),cex=.8)
dotchart(exercise2_3_1$æ°”æ¸©,groups=
exercise2_3_1$åŸå¸‚,xlab="æ°”æ¸©",pch=12,col="brown")
```

### æŒ‰åŸå¸‚ç»˜åˆ¶è½®å»“å›¾å’Œé›·è¾¾å›¾
```{r,fig.height = 3, fig.width = 4}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch2/exercise2_3.RData?raw=True")
par(mai=c(.7,.7,.1,.1),cex=.8)
matplot(t(exercise2_3[2:11]),type='b',lty=1:12,col=rainbow(12),lwd=2,xlab="åŸå¸‚",ylab ="æ°”æ¸©",pch=1,xaxt="n")
axis(side=1,at=2:11,labels=c("åŒ—äº¬","æ²ˆé˜³","ä¸Šæµ·","å—æ˜Œ","éƒ‘å·","æ­¦æ±‰","å¹¿å·","æµ·å£","é‡åº†","æ˜†æ˜"),cex.axis=0.7)
legend(x="topright",legend=exercise2_3[,1],lty=1:12,col=rainbow(12),text.width=2,cex=0.8)
```

### ç»˜åˆ¶é›·è¾¾å›¾
```{r,fig.height = 3, fig.width = 4}
par(mai=c(0.5,0.5,0.5,0.5),cex=0.8)
library(fmsb)
radarchart(exercise2_3[,2:11],axistype=0,seg=4,maxmin=FALSE,vlabels=names(exercise2_3[,2:11]),pcol=rainbow(7),plwd=3)
legend(x="topleft",legend=c("åŒ—äº¬","æ²ˆé˜³","ä¸Šæµ·","å—æ˜Œ","éƒ‘å·","æ­¦æ±‰","å¹¿å·","æµ·å£","é‡åº†","æ˜†æ˜"),col=1:10,lwd=1,text.width=0.5,cex=0.7)

```

### åˆ†åˆ«æŒ‰æœˆä»½å’ŒåŸå¸‚ç»˜åˆ¶æ˜Ÿå›¾å’Œè„¸è°±å›¾
```{r, fig.height = 4, fig.width = 6}
matrix2_3=as.matrix(exercise2_3[,2:11])
rownames(matrix2_3)=exercise2_3[,1] 
stars(matrix2_3,key.loc=c(10,2,5),cex=0.8,main='ä¸åŒæœˆä»½çš„æ˜Ÿå›¾')
```

### æŒ‰æœˆä»½ç»˜åˆ¶æ˜Ÿå›¾
```{r,fig.height = 5, fig.width =7}
stars(t(matrix2_3),full=F,draw.segments=TRUE,key.loc=c(10,1.85,5),cex=0.8,main='ä¸åŒåŸå¸‚çš„æ˜Ÿå›¾')
```

### ç»˜åˆ¶è„¸è°±å›¾
```{r, fig.height = 3, fig.width = 4}
library(aplpack)
faces(matrix2_3,nrow.plot=3,ncol.plot=4,face.type=3,main='ä¸åŒæœˆä»½çš„è„¸è°±å›¾')
faces(t(matrix2_3),nrow.plot=2,ncol.plot=5,face.type=0,main='ä¸åŒåŸå¸‚çš„è„¸è°±å›¾')
```

## ä¸‹è¡¨æ˜¯2011å¹´æˆ‘å›½31ä¸ªåœ°åŒºçš„åœ°åŒºç”Ÿäº§æ€»å€¼ï¼ˆæŒ‰æ”¶å…¥æ³•è®¡ç®—ï¼‰ã€å…¨ç¤¾ä¼šå›ºå®šèµ„äº§æŠ•èµ„å’Œæœ€ç»ˆæ¶ˆè´¹æ”¯å‡ºæ•°æ®ï¼ˆå•ä½ï¼šäº¿å…ƒï¼‰
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch2/exercise2_4.RData?raw=True")
head(exercise2_4,10)
```

### ç»˜åˆ¶æ•£ç‚¹å›¾å’Œæ°”æ³¡å›¾åˆ†æå„å˜é‡ä¹‹é—´çš„å…³ç³»

### æ•£ç‚¹å›¾
```{r, fig.height = 3, fig.width = 4}
attach(exercise2_4)
par(mai=c(0.7,0.8,0.1,0.1),cex=0.6)
plot(å›ºå®šèµ„äº§æŠ•èµ„,åœ°åŒºç”Ÿäº§æ€»å€¼,xlab="",ylab="åœ°åŒºç”Ÿäº§æ€»å€¼")
abline(lm(åœ°åŒºç”Ÿäº§æ€»å€¼~å›ºå®šèµ„äº§æŠ•èµ„,data=exercise2_4),lty=2)
points(æœ€ç»ˆæ¶ˆè´¹æ”¯å‡º,åœ°åŒºç”Ÿäº§æ€»å€¼,pch=2,col="blue")
abline(lm(åœ°åŒºç”Ÿäº§æ€»å€¼~æœ€ç»ˆæ¶ˆè´¹æ”¯å‡º,data=exercise2_4),col="blue",lty=3)
legend(0, 54000, c("å¯¹å›ºå®šèµ„äº§æŠ•èµ„å›å½’", "å¯¹æœ€ç»ˆæ¶ˆè´¹æ”¯å‡ºå›å½’"),col = c("black","blue"),lty = c(2, 3))
```

### ç»˜åˆ¶æ°”æ³¡å›¾
```{r, fig.height = 3, fig.width = 4}
par(mai=c(0.9,0.9,0.1,0.1))
r<- sqrt(åœ°åŒºç”Ÿäº§æ€»å€¼/pi) 
symbols(å›ºå®šèµ„äº§æŠ•èµ„,æœ€ç»ˆæ¶ˆè´¹æ”¯å‡º,circles=r,inches=0.3,fg="white",bg="lightblue", ylab="æœ€ç»ˆæ¶ˆè´¹æ”¯å‡º",xlab="å›ºå®šèµ„äº§æŠ•èµ„",ylim=c(0,35000),xlim=c(0,30000))
text(å›ºå®šèµ„äº§æŠ•èµ„,æœ€ç»ˆæ¶ˆè´¹æ”¯å‡º,rownames(exercise2_4),cex=0.6)
mtext("æ°”æ³¡å¤§å° = åœ°åŒºç”Ÿäº§æ€»å€¼",line=-1,cex=.8,adj=0.1)
```

### ç»˜åˆ¶æ˜Ÿå›¾å’Œè„¸è°±å›¾æ¯”è¾ƒ31ä¸ªåœ°åŒºå„é¡¹æ•°æ®çš„ç›¸ä¼¼æ€§

### æŒ‰åŸå¸‚ç»˜åˆ¶æ˜Ÿå›¾
```{r, fig.height = 3, fig.width = 3}
matrix2_4=as.matrix(exercise2_4[,2:4])
rownames(matrix2_4)=exercise2_4[,1] 
stars(t(matrix2_4),full=F,draw.segments=TRUE,key.loc=c(10,1.85,5),cex=0.8,main='å„æŒ‡æ ‡æ˜Ÿå›¾')
```

### è„¸è°±å›¾
```{r, fig.height = 2.8, fig.width = 4}
library(aplpack)
faces(t(matrix2_4),nrow.plot=1,ncol.plot=3,face.type=0,main='å„æŒ‡æ ‡çš„è„¸è°±å›¾',cex=0.9)
```

## ä¸‹è¡¨æ˜¯2005å¹´â€”2014å¹´æˆ‘å›½åŸé•‡å±…æ°‘å’Œå†œæ‘å±…æ°‘çš„CPIæ•°æ®
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch2/exercise2_5.RData?raw=True")
exercise2_5
```

### ç»˜åˆ¶æ—¶é—´åºåˆ—å›¾ï¼Œè§‚å¯Ÿå±…æ°‘å’Œå†œæ‘å±…æ°‘æ¶ˆè´¹ä»·æ ¼æŒ‡æ•°çš„å˜åŒ–ç‰¹å¾
```{r, fig.height = 3, fig.width = 4}
par(mai=c(0.7,0.7,0.1,0.1),cex=0.8,fg=2) 
plot(exercise2_5[,2],lwd=2,ylim=c(100,110),xlab="å¹´ä»½",ylab="å±…æ°‘æ¶ˆè´¹æ°´å¹³",type="n")
grid(col="gray60")
points(exercise2_5[,2],type='o',lwd=2,ylim=c(100,110),xlab="å¹´ä»½",ylab="å±…æ°‘æ¶ˆè´¹æ°´å¹³")
lines(exercise2_5[,3],type='b',lty=2,lwd=2,col="blue")
legend(x="topleft",legend=c("åŸé•‡å±…æ°‘","å†œæ‘å±…æ°‘"),lty=1:2,col=c(1,3),cex=0.8)
```

  åˆ†æï¼š2005å¹´â€”2014å¹´å†œæ‘å±…æ°‘çš„æ¶ˆè´¹ä»·æ ¼æŒ‡æ•°æ•´ä½“ä¸Šç•¥é«˜äºåŸå¸‚ï¼Œè¯´æ˜å†œæ‘ç»æµç›®å‰å¢é€Ÿå¤§äºåŸå¸‚ã€‚ä½†æ— è®ºåŸå¸‚äº¦æˆ–å†œæ‘CPIå˜åŒ–ç¨‹åº¦ä¸å¤§ï¼Œè¯´æ˜ç‰©ä»·ç›¸å¯¹ç¨³å®šã€‚

## å‡å®šæŸåœ°åŒºä¸åŒæ”¶å…¥é˜¶å±‚çš„äººå£æ•°å’Œä¸åŒé˜¶å±‚äººå£çš„å¹´æ”¶å…¥é¢å¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚ç»˜åˆ¶æ´›ä¼¦å…¹æ›²çº¿åˆ†ææ”¶å…¥åˆ†é…çš„ä¸å¹³ç­‰ç¨‹åº¦ã€‚

### ç»˜åˆ¶æ´›ä¼¦å…¹æ›²çº¿åˆ†ææ”¶å…¥åˆ†é…çš„ä¸å¹³ç­‰ç¨‹åº¦
```{r, fig.height = 3, fig.width = 4}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch2/exercise2_6.RData?raw=True")
exercise2_6
library(DescTools)
Lc(exercise2_6$"ä¸åŒé˜¶å±‚äººå£æ•°çš„æ”¶å…¥é¢",exercise2_6$"ä¸åŒæ”¶å…¥é˜¶å±‚çš„äººå£æ•°")
par(mai=c(0.7,0.7,0.4,0.1),cex=0.8)
plot(Lc(exercise2_6$"ä¸åŒé˜¶å±‚äººå£æ•°çš„æ”¶å…¥é¢",exercise2_6$"ä¸åŒæ”¶å…¥é˜¶å±‚çš„äººå£æ•°"),xlab="äººæ•°æ¯”ä¾‹",ylab="æ”¶å…¥æ¯”ä¾‹",col=4,panel.first=grid(10,10,col="gray70"))
```

  åˆ†æï¼šæ´›ä¼¦å…¹æ›²çº¿å¼¯æ›²ç¨‹åº¦è¾ƒå¤§ï¼Œè¿œç¦»å¹³å‡çº¿ï¼Œè¡¨ç¤ºæ”¶å…¥åˆ†é…çš„ä¸å¹³ç­‰ç¨‹åº¦è¾ƒå¤§ã€‚

# ç¬¬ä¸‰ç«  æ•°æ®çš„æè¿°ç»Ÿè®¡é‡

## 50ä¸ªæ¶ˆè´¹è€…ç½‘è´­é‡‘é¢
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch3/exercise3_1.RData?raw=True")
head(exercise3_1,10)
```

### è®¡ç®—å¹³å‡æ•°ã€æ ‡å‡†å·®ã€æå·®å’Œå››åˆ†ä½æ•°
```{r}
mean(exercise3_1$"ç½‘è´­é‡‘é¢")
sd(exercise3_1$"ç½‘è´­é‡‘é¢")
range=max(exercise3_1$"ç½‘è´­é‡‘é¢")-min(exercise3_1$"ç½‘è´­é‡‘é¢")
range
IQR(exercise3_1$"ç½‘è´­é‡‘é¢",type=6)
```

### è®¡ç®—10%ï¼Œ25%ï¼Œ50%ï¼Œ75%ï¼Œ90%çš„åˆ†ä½æ•°
```{r}
quantile(exercise3_1$"ç½‘è´­é‡‘é¢",probs=c(0.1,0.25,0.5,0.75,0.90),type=6)
```

### è®¡ç®—æ ‡å‡†åˆ†æ•°æ£€æµ‹ç¦»ç¾¤ç‚¹

### è®¡ç®—æ ‡å‡†åˆ†æ•°å¹¶å°†ç»“æœä¿ç•™å››ä½å°æ•°
```{r}
a=round(scale(exercise3_1$"ç½‘è´­é‡‘é¢"),4)
```

### æ–¹æ³•ç­›é€‰ç¦»ç¾¤ç‚¹
```{r}
subset(exercise3_1,ç½‘è´­é‡‘é¢>(3*sd(exercise3_1$"ç½‘è´­é‡‘é¢")+mean(exercise3_1$"ç½‘è´­é‡‘é¢"))|ç½‘è´­é‡‘é¢<((-3)*sd(exercise3_1$"ç½‘è´­é‡‘é¢")+mean(exercise3_1$"ç½‘è´­é‡‘é¢")))
```

### è®¡ç®—ååº¦ç³»æ•°å’Œå³°åº¦ç³»æ•°ï¼Œåˆ†æç½‘è´­é‡‘é¢çš„åˆ†å¸ƒç‰¹ç‚¹

### è®¡ç®—ååº¦ç³»æ•°
```{r}
library(agricolae)
skewness(exercise3_1$"ç½‘è´­é‡‘é¢")
kurtosis(exercise3_1$"ç½‘è´­é‡‘é¢")
```
  åˆ†æï¼šååº¦ç³»æ•°ä¸º0.6633ï¼Œå±äºä¸­ç­‰åæ–œåˆ†å¸ƒï¼Œå³ååˆ†å¸ƒã€‚å³°åº¦ç³»æ•°ä¸º1.2203>0ï¼Œä¸ºå°–å³°åˆ†å¸ƒï¼Œæ•°æ®ç›¸å¯¹é›†ä¸­ã€‚

## è®¡ç®—ç»Ÿè®¡é‡åŠç”»ç®±çº¿å›¾
```{r, fig.height = 3, fig.width = 4}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch3/exercise3_2.RData?raw=True")
library(pastecs)
round(stat.desc(exercise3_2),4)
par(mfrow=c(1,3),cex=0.6,mai=c(0.7,0.7,0.1,0.1))
boxplot(exercise3_2$"æ–¹æ³•A",col="lightblue",xlab="æ–¹æ³•A",ylab="äº§å“æ•°é‡",cex.lab=0.8,cex.axis=0.6)
boxplot(exercise3_2$"æ–¹æ³•B",col="lightblue",xlab="æ–¹æ³•B",ylab="äº§å“æ•°é‡",cex.lab=0.8,cex.axis=0.6)
boxplot(exercise3_2$"æ–¹æ³•C",col="lightblue",xlab="æ–¹æ³•C",ylab="äº§å“æ•°é‡",cex.lab=0.8,cex.axis=0.6)
```

## åœ¨å¤§å­¦ç”Ÿä¸­éšæœºæŠ½å–50åç”·ç”Ÿå’Œ50åå¥³ç”Ÿï¼Œæµ‹å¾—èº«é«˜æ•°æ®å¦‚ä¸‹
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch3/exercise3_3.RData?raw=True")
head(exercise3_3,10)
```

### ç»˜åˆ¶èƒŒé èƒŒèŒå¶å›¾ï¼Œè®¡ç®—æœ‰å…³æè¿°æ€§ç»Ÿè®¡é‡ï¼Œæ¯”è¾ƒç”·å¥³ç”Ÿèº«é«˜çš„ç‰¹ç‚¹å’Œå·®å¼‚

### èƒŒé èƒŒèŒå¶å›¾
```{r}
library(aplpack)
stem.leaf.backback(exercise3_3$"ç”·ç”Ÿ",exercise3_3$"å¥³ç”Ÿ")
```

### è®¡ç®—å„ç»Ÿè®¡é‡
```{r}
library(pastecs)
round(stat.desc(exercise3_3),4)
```
 
  åˆ†æï¼šç”±ç”·ç”Ÿå’Œå¥³ç”Ÿçš„èƒŒé èƒŒèŒå¶å›¾å¯ä»¥çœ‹å‡ºï¼Œå¥³ç”Ÿèº«é«˜é›†ä¸­åœ¨160cm-175cmä¹‹é—´ï¼Œè€Œç”·ç”Ÿèº«é«˜é›†ä¸­åœ¨170cm-190cmä¹‹é—´ã€‚åˆ†åˆ«è®¡ç®—ç”·å¥³ç”Ÿèº«é«˜çš„ç»Ÿè®¡é‡ï¼Œç”·ç”Ÿå¹³å‡èº«é«˜ä¸º178.56ï¼Œå¥³ç”Ÿå¹³å‡èº«é«˜ä¸º167.856ã€‚æ¯”è¾ƒè€Œè¨€ï¼Œç”·ç”Ÿèº«é«˜æ ‡å‡†å·®ä¸º6.6579ï¼Œå¤§äºå¥³ç”Ÿèº«é«˜æ ‡å‡†å·®ï¼Œæ‰€ä»¥ç”·ç”Ÿä¹‹é—´èº«é«˜å·®å¼‚è¾ƒå¤§ã€‚

# ç¬¬å››ç«  éšæœºå˜é‡çš„æ¦‚ç‡åˆ†å¸ƒ

## æ¶ˆè´¹è€…åä¼šç»è¿‡è°ƒæŸ¥å‘ç°ï¼ŒæŸå“ç‰Œå†·æ°”æœºé‡è¦ç¼ºé™·çš„äº§å“æ•°å‡ºç°çš„æ¦‚ç‡åˆ†å¸ƒå¦‚ä¸‹ï¼š
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch4/exercise4_1.RData?raw=True")
exercise4_1
```
### æœ‰2~5å°ï¼ˆåŒ…æ‹¬2å°ä¸5å°åœ¨å†…ï¼‰å†·æ°”æœºå‡ºç°é‡è¦ç¼ºé™·çš„æ¦‚ç‡
```{r}
p1<-0.209	
p2<-0.223
p3<-0.178
p4<-0.114
p<-p1+p2+p3+p4
p
```

### åªæœ‰ä¸åˆ°2å°å†·æ°”æœºå‡ºç°é‡è¦ç¼ºé™·çš„æ¦‚ç‡
```{r}
p1<-0.041
p2<-0.130
pp<-p1+p2
pp
```
### æœ‰è¶…è¿‡5å°å†·æ°”æœºå‡ºç°é‡è¦ç¼ºé™·çš„æ¦‚ç‡
```{r}
p1<-0.061
p2<-0.028
p3<-0.011
p4<-0.004
p5<-0.001
ppp<-p1+p2+p3+p4+p5
ppp
```
## è®¾Xæ˜¯å‚æ•°ä¸ºn=4å’Œp=0.1çš„äºŒé¡¹éšæœºå˜é‡ï¼Œæ±‚ä»¥ä¸‹æ¦‚ç‡
### P(X=2)
```{r}
dbinom(2,4,0.1) 
```
### P(Xâ‰¤1)
```{r}
pbinom(1,4,0.1) 
```
## è®¡ç®—ä»¥ä¸‹æ¦‚ç‡å’Œåˆ†ä½ç‚¹
### 4.3.1 X~N(500,20Â²);P(Xâ‰¥510);P(400â‰¤Xâ‰¤450)
```{r}
1-pnorm(510,mean=500,sd=20)
pnorm(450,mean=500,sd=20)-pnorm(400,mean=500,sd=20)
```
### Z~N(0,1);P(0â‰¤Zâ‰¤1.2);P(-0.48â‰¤Zâ‰¤0);P(Zâ‰¥1.2)
```{r}
pnorm(1.2,mean=0,sd=1)-pnorm(0,mean=0,sd=1)
pnorm(0,mean=0,sd=1)-pnorm(-0.48,mean=0,sd=1)
1-pnorm(1.2,mean=0,sd=1)
```
### æ ‡å‡†æ­£æ€åˆ†å¸ƒç´¯è®¡é¢‘ç‡ä¸º0.95æ—¶çš„åå‡½æ•°å€¼z
```{r}
qnorm(0.475,mean=0,sd=1)
```
## è®¡ç®—ä»¥ä¸‹æ¦‚ç‡å’Œåˆ†ä½ç‚¹ï¼š
### X~t(df),df=15,tå€¼å°äº-1.5çš„æ¦‚ç‡ï¼›df=20ï¼Œtå€¼å¤§äº2çš„æ¦‚ç‡ï¼›df=30,tåˆ†å¸ƒå³å°¾æ¦‚ç‡0.05æ—¶çš„tå€¼
```{r}
pt(-1.5,df=15)
1-pt(2,df=20)
qt(0.95,df=30)
```

### X~Chi-square(df),df=8,$\chi^2$å€¼å°äº12çš„æ¦‚ç‡ï¼›df=20,$\chi^2$å€¼å¤§äº18çš„æ¦‚ç‡;df=15.$\chi^2$åˆ†å¸ƒå³å°¾æ¦‚ç‡ä¸º0.025æ—¶çš„åå‡½æ•°å€¼.
```{r}
pchisq(12,df=8)
1-pchisq(18,df=20)
qchisq(0.975,df=15)
```
## æŠ½å–ä¸åŒçš„æ ·æœ¬é‡æ¨¡æ‹Ÿä»¥ä¸‹åˆ†å¸ƒ
### æ­£æ€åˆ†å¸ƒï¼Œæ¥è‡ªæ­£æ€æ€»ä½“çš„æ ·æœ¬
```{r, fig.height = 3, fig.width = 4}
par(mai=c(0.75,0.75,0.1,0.1),cex=0.9)
curve(dnorm(x,0,sqrt(1/2)),from=-3,to=3,xlim=c(-4,4),ylab="f(x)",lty=1,col=2,lwd=3)
abline(h=0)
segments(0,0,0,0.56,col="blue",lty=2,lwd=1.5)
curve(dnorm(x,mean=0,sd=1),from=-4,to=4,add=TRUE,lty=2,lwd=3)
curve(dnorm(x,0,sqrt(2)),from=-4,to=4,add=TRUE,lty=3,col=4,lwd=3)
legend(x="topright",legend=c("N(0,0.5)","N(0,1)","N(0,2)"),inset=0.001,lty=1:3,col=c(2,"black",4))
```


### æ ·æœ¬å‡å€¼çš„åˆ†å¸ƒï¼Œæ¥è‡ªä»»æ„æ€»ä½“çš„æ ·æœ¬
```{r, fig.height = 4, fig.width = 5}
par(mfrow=c(1,3),mai=c(0.7,0.7,0.4,0.2),cex=0.8)
x<-vector()
n=10
for(i in 1:1000){
  x<-append(x,mean(sample(100,n,replace=F)))
}
head(x,100)
hist(x,prob=T,xlim=c(0,100),ylim=c(0,0.05),col="lightblue",xlab="æ ·æœ¬å‡å€¼",main="æ ·æœ¬å‡å€¼çš„åˆ†å¸ƒ",cex.main=.8)
lines(density(x),col="red",lwd=2)
x<-vector();m<-vector()
n=30
for(i in 1:1000){
  x<-append(x,mean(sample(100,n,replace=F)))
}
head(x,100)
hist(x,prob=T,xlim=c(0,100),ylim=c(0,0.1),col="lightblue",xlab="æ ·æœ¬å‡å€¼",main="æ ·æœ¬å‡å€¼çš„åˆ†å¸ƒ",cex.main=.8)
lines(density(x),col="red",lwd=2)
x<-vector();m<-vector()
n=50
for(i in 1:1000){
  x<-append(x,mean(sample(100,n,replace=F)))
}
head(x,100)
hist(x,prob=T,xlim=c(0,100),ylim=c(0,0.15),col="lightblue",xlab="æ ·æœ¬å‡å€¼",main="æ ·æœ¬å‡å€¼çš„åˆ†å¸ƒ",cex.main=.8)
lines(density(x),col="red",lwd=2)
```


### æ ·æœ¬æ¯”ä¾‹çš„åˆ†å¸ƒï¼Œæ¥è‡ªä»»æ„æ€»ä½“çš„æ ·æœ¬
```{r, fig.height = 3, fig.width = 5}
par(mai=c(1.2,1.2,0.5,0.5))
p=rbinom(1000,1000,.2)/1000
head(p,100)
hist(p,prob=T,xlim=c(0.1,0.3),ylim=c(0,34),col="lightblue",xlab="æ ·æœ¬æ¯”ä¾‹",main="æ¨¡æ‹Ÿæ ·æœ¬æ¯”ä¾‹çš„åˆ†å¸ƒ",cex.main=.8)
lines(density(p),col="red",lwd=2)
```

### æ ·æœ¬æ–¹å·®çš„åˆ†å¸ƒï¼Œæ¥è‡ªæ­£æ€æ€»ä½“çš„æ ·æœ¬
```{r, fig.height = 3, fig.width = 5}
v<-vector()
n=30
for(i in 1:1000){
  v<-append(v,var(rnorm(n)))
}
hist(v,prob=T,xlim=c(0,2),ylim=c(0,1.8),col="lightblue",xlab="æ ·æœ¬æ–¹å·®",main="æ¨¡æ‹Ÿæ ·æœ¬æ–¹å·®çš„åˆ†å¸ƒ",cex.main=.8)
lines(density(v),col="red",lwd=2)
```


# ç¬¬äº”ç«  å‚æ•°ä¼°è®¡
## æŸå¿«é¤åº—æƒ³è¦ä¼°è®¡æ¯ä½é¡¾å®¢åˆé¤çš„å¹³å‡èŠ±è´¹é‡‘é¢,åœ¨ä¸ºæœŸ3å‘¨çš„æ—¶é—´é‡Œé€‰å–49åé¡¾å®¢ç»„æˆäº†ä¸€ä¸ªç®€å•éšæœºæ ·æœ¬,å¾—åˆ°æ ·æœ¬å‡å€¼ä¸º120å…ƒï¼Œæ ‡å‡†å·®ä¸º15å…ƒï¼Œæ±‚æ€»ä½“å‡å€¼Î¼çš„95ï¼…çš„ç½®ä¿¡åŒºé—´ã€‚
```{r}
xbar=120
s=15
n=49
q=qnorm(0.975)
LCI=xbar-q*s/sqrt(n)
UCI=xbar+q*s/sqrt(n)
data.frame(LCI,UCI)
```
## åˆ©ç”¨ä¸‹é¢çš„ä¿¡æ¯ï¼Œæ„å»ºæ€»ä½“å‡å€¼Î¼çš„ç½®ä¿¡åŒºé—´
### æ€»ä½“æœä»æ­£æ€åˆ†å¸ƒã€‚å·²çŸ¥æ ‡å‡†å·®\sigma=500ï¼Œn=15ï¼Œæ ·æœ¬å‡å€¼=8900ã€‚ç½®ä¿¡æ°´å¹³ä¸º95%
```{r}
xbar=8900
sigma=500
n=15
q=qnorm(0.975)
LCI=xbar-q*sigma/sqrt(n)
UCI=xbar+q*sigma/sqrt(n)
data.frame(LCI,UCI)
```


### æ€»ä½“ä¸æœä»æ­£æ€åˆ†å¸ƒ.å·²çŸ¥\sigma=500ï¼Œn=35ï¼Œæ ·æœ¬å‡å€¼=8900ã€‚ç½®ä¿¡æ°´å¹³ä¸º95%.
```{r}
xbar=8900
sigma=500
n=35
q=qnorm(0.975)
LCI=xbar-q*sigma/sqrt(n)
UCI=xbar+q*sigma/sqrt(n)
data.frame(LCI,UCI)
```


### æ€»ä½“ä¸æœä»æ­£æ€åˆ†å¸ƒã€‚å·²çŸ¥\sigmaæœªçŸ¥ï¼Œn=35ï¼Œæ ·æœ¬å‡å€¼=8900ï¼Œs=510ã€‚ç½®ä¿¡æ°´å¹³ä¸º90%
```{r}
xbar=8900
s=510
n=35
q<-qnorm(0.95)
LCI=xbar-q*s/sqrt(n)
UCI=xbar+q*s/sqrt(n)
data.frame(LCI,UCI)
```
### æ€»ä½“ä¸æœä»æ­£æ€åˆ†å¸ƒã€‚å·²çŸ¥\sigmaæœªçŸ¥ï¼Œn=100ï¼Œæ ·æœ¬å‡å€¼=8900ï¼Œs=510ã€‚ç½®ä¿¡æ°´å¹³ä¸º95%
```{r}
xbar=8900
s=500
n=100
q=qnorm(0.975)
LCI=xbar-q*s/sqrt(n)
UCI=xbar+q*s/sqrt(n)
data.frame(LCI,UCI)
```

## æŸå¤§å­¦ä¸ºäº†äº†è§£å­¦ç”Ÿæ¯å¤©ä¸Šç½‘çš„æ—¶é—´ï¼Œåœ¨å…¨æ ¡å­¦ç”Ÿä¸­éšæœºæŠ½å–36äººï¼Œè°ƒæŸ¥ä»–ä»¬æ¯å¤©çš„ä¸Šç½‘æ—¶é—´ï¼Œå¾—åˆ°çš„æ•°æ®å¦‚ä¸‹ï¼ˆå•ä½ï¼šå°æ—¶ï¼‰ï¼šæ±‚è¯¥æ ¡å¤§å­¦ç”Ÿå¹³å‡ä¸Šç½‘æ—¶é—´çš„ç½®ä¿¡åŒºé—´ï¼Œç½®ä¿¡æ°´å¹³åˆ†åˆ«ä¸º90%ï¼Œ95%å’Œ99%ã€‚
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch5/exercise5_3.RData?raw=True")
head(exercise5_3,10)
```

```{r}
library(BSDA)
z.test(exercise5_3$"ä¸Šç½‘æ—¶é—´",mu=0,sigma.x=sd(exercise5_3$"ä¸Šç½‘æ—¶é—´"),conf.level=0.90)
z.test(exercise5_3$"ä¸Šç½‘æ—¶é—´",mu=0,sigma.x=sd(exercise5_3$"ä¸Šç½‘æ—¶é—´"),conf.level=0.95)
z.test(exercise5_3$"ä¸Šç½‘æ—¶é—´",mu=0,sigma.x=sd(exercise5_3$"ä¸Šç½‘æ—¶é—´"),conf.level=0.99)
```

## æŸå±…æ°‘å°åŒºå…±æœ‰å±…æ°‘500æˆ·ï¼Œå°åŒºç®¡ç†è€…å‡†å¤‡é‡‡å–ä¸€é¡¹æ–°çš„ä¾›æ°´è®¾æ–½ï¼Œæƒ³äº†è§£å±…æ°‘æ˜¯å¦èµæˆã€‚é‡‡å–é‡å¤æŠ½æ ·æ–¹æ³•éšæœºæŠ½å–äº†50æˆ·ï¼Œå…¶ä¸­æœ‰32æˆ·èµæˆï¼Œ18æˆ·åå¯¹ã€‚ä¼°è®¡æ€»ä½“ä¸­èµæˆé‡‡ç”¨æ–°è®¾æ–½çš„æˆ·æ•°æ¯”ä¾‹çš„ç½®ä¿¡åŒºé—´ï¼Œç½®ä¿¡æ°´å¹³ä¸º95ï¼…ã€‚
```{r}
n<-50
x<-32
p<-x/n
q<-qnorm(0.975)
LCI<-p-q*sqrt(p*(1-p)/n)
UCI<-p+q*sqrt(p*(1-p)/n)
data.frame(LCI,UCI)
```
## ä¸ºæ¯”è¾ƒå“ªç§æ’é˜Ÿæ–¹å¼ä½¿é¡¾å®¢ç­‰å¾…çš„æ—¶é—´æ›´çŸ­ï¼Œé“¶è¡Œå„éšæœºæŠ½å–10åé¡¾å®¢,ä»–ä»¬åœ¨åŠç†ä¸šåŠ¡æ—¶æ‰€ç­‰å¾…çš„æ—¶é—´(å•ä½:åˆ†é’Ÿ)å¦‚ä¸‹:
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch5/exercise5_5.RData?raw=True")
exercise5_5
```
### æ„å»ºç¬¬ä¸€ç§æ’é˜Ÿæ–¹å¼ç­‰å¾…æ—¶é—´å‡å€¼çš„95%çš„ç½®ä¿¡åŒºé—´
```{r}
library(BSDA)
z.test(exercise5_5$æ–¹å¼1,mu=0,sigma.x=sd(exercise5_5$æ–¹å¼1),conf.level=0.95)
```


### æ„å»ºç¬¬äºŒç§æ’é˜Ÿæ–¹å¼ç­‰å¾…æ—¶é—´æ–¹å·®çš„95%çš„ç½®ä¿¡åŒºé—´
```{r}
library(TeachingDemos)
sigma.test(exercise5_5$"æ–¹å¼2",conf.level=0.95)$conf.int
```


### æ„å»ºä¸¤ç§æ–¹å¼æ’é˜Ÿæ—¶é—´å‡å€¼ä¹‹å·®çš„95%çš„ç½®ä¿¡åŒºé—´

### æ–¹å·®ç›¸ç­‰
```{r}
t.test(x=exercise5_5$æ–¹å¼1,y=exercise5_5$æ–¹å¼2,var.equal=TRUE)$conf.int
```
### æ–¹å·®ä¸ç›¸ç­‰
```{r}
t.test(x=exercise5_5$æ–¹å¼1,y=exercise5_5$æ–¹å¼2,var.equal=F)$conf.int
```
## æ ¹æ®å·²æœ‰æ•°æ®æ„å»ºä¸¤ä¸ªæ­£å¤ªåˆ†å¸ƒæ€»ä½“

### è®¡ç®—$Î¼_1$-$Î¼_2$çš„95%çš„ç½®ä¿¡åŒºé—´
```{r}
x<-rnorm(14,53.2,96.8)
y<-rnorm(7,43.4,102.0)
t.test(x,y,var.equal=TRUE,conf.level=0.95)$conf.int
```


### è®¡ç®—$Î¼_1$-$Î¼_2$çš„99%çš„ç½®ä¿¡åŒºé—´
```{r}
x<-rnorm(14,53.2,96.8)
y<-rnorm(7,43.4,102.0)
t.test(x,y,var.equal=TRUE,conf.level=0.99)$conf.int
```
## ä¸€å®¶äººæ‰æµ‹è¯„æœºæ„å¯¹éšæœºæŠ½å–çš„10åå°ä¼ä¸šçš„ç»ç†äººç”¨ä¸¤ç§æ–¹æ³•è¿›è¡Œçš„ä¿¡å¿ƒæµ‹è¯•ï¼Œå¾—åˆ°çš„è‡ªä¿¡å¿ƒæµ‹è¯•åˆ†æ•°å¦‚ä¸‹ï¼š
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch5/exercise5_7.RData?raw=True")
exercise5_7
```


 æ„å»ºä¸¤ç§æ–¹æ³•å¹³å‡è‡ªä¿¡å¿ƒå¾—åˆ†ä¹‹å·®$Î¼_d$=$Î¼_1$-$Î¼_2$çš„95%çš„ç½®ä¿¡åŒºé—´
```{r}
t.test(exercise5_7$æ–¹æ³•1,exercise5_7$æ–¹æ³•2,paired=TRUE)$conf.int
```

## ä»ä¸¤ä¸ªæ€»ä½“ä¸­å„æŠ½å–ä¸€ä¸ª$n_1$=$n_2$=250çš„ç‹¬ç«‹éšæœºæ ·æœ¬ï¼Œæ¥è‡ªæ€»ä½“1çš„æ ·æœ¬æ¯”ä¾‹ä¸º$p_1$=40%ï¼Œæ¥è‡ªæ€»ä½“2çš„æ ·æœ¬æ¯”ä¾‹ä¸º$p_2$=30%
### 5.8.1æ„é€ $Ï€_1$-$Ï€_2$=90%çš„ç½®ä¿¡åŒºé—´
```{r}
n1<-250
n2<-250
p1<-0.4
p2<-0.3
q<-qnorm(0.95)
LCI<-p1-p2-q*sqrt(p1*(1-p1)/n1+p2*(1-p2)/n2)
UCI<-p1-p2+q*sqrt(p1*(1-p1)/n1+p2*(1-p2)/n2)
data.frame(LCI,UCI) 
```


### æ„é€ $Ï€_1$-$Ï€_2$=95%çš„ç½®ä¿¡åŒºé—´
```{r}
n1<-250
n2<-250
p1<-0.4
p2<-0.3
q<-qnorm(0.975)
LCI<-p1-p2-q*sqrt(p1*(1-p1)/n1+p2*(1-p2)/n2)
UCI<-p1-p2+q*sqrt(p1*(1-p1)/n1+p2*(1-p2)/n2)
data.frame(LCI,UCI)
```
## ç”Ÿäº§å·¥åºçš„æ–¹å·®æ˜¯å·¥åºè´¨é‡çš„ä¸€ä¸ªé‡è¦åº¦é‡ã€‚å½“æ–¹å·®è¾ƒå¤§æ—¶ï¼Œéœ€è¦å¯¹å·¥åºè¿›è¡Œæ”¹è¿›ä»¥å‡å°æ–¹å·®ã€‚ä¸‹é¢æ˜¯ä¸¤éƒ¨æœºå™¨ç”Ÿäº§çš„è¢‹èŒ¶é‡é‡(å•ä½ï¼šg)çš„æ•°æ®ï¼š
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch5/exercise5_9.RData?raw=True")
head(exercise5_9,10)
```


 æ„é€ ä¸¤ä¸ªæ€»ä½“æ–¹å·®æ¯”$Ïƒ_1$Â²/$Ïƒ_2$Â²çš„95%çš„ç½®ä¿¡åŒºé—´
```{r}
var.test(exercise5_9$æœºå™¨1,exercise5_9$æœºå™¨2,alternative="two.sided")$conf.int
```
# ç¬¬å…­ç«  å‡è®¾æ£€éªŒ

## ä¸€ç§æœºåºŠåŠ å·¥çš„é›¶ä»¶å°ºå¯¸ç»å¯¹å¹³å‡è¯¯å·®ä¸º1.35mmï¼Œç”Ÿäº§å‚å®¶å‡†å¤‡é‡‡ç”¨ä¸€ç§æ–°çš„æœºåºŠä»¥è¿›ä¸€æ­¥é™ä½è¯¯å·®ï¼Œä¸ºæ£€æµ‹æ–°æœºåºŠåŠ å·¥çš„é›¶ä»¶å¹³å‡è¯¯å·®ä¸æ—§æœºåºŠç›¸æ¯”æ˜¯å¦æœ‰æ˜¾è‘—é™ä½ï¼Œä»æ–°æœºåºŠç”Ÿäº§çš„é›¶ä»¶ä¸­éšæœºæŠ½å–50ä¸ªè¿›è¡Œæ£€éªŒã€‚50ä¸ªé›¶ä»¶å°ºå¯¸çš„ç»å¯¹è¯¯å·®æ•°æ®ï¼ˆå•ä½ï¼šmmï¼‰å¦‚ä¸‹ï¼š
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch6/exercise6_1.RData?raw=True")
head(exercise6_1,10)
```

### ç»˜åˆ¶Q-Qå›¾ï¼Œæ£€éªŒé›¶ä»¶å°ºå¯¸çš„ç»å¯¹è¯¯å·®æ˜¯å¦æœä»æ­£æ€åˆ†å¸ƒ
```{r, fig.height = 2, fig.width = 3}
par(cex=0.8,mai=c(0.7,0.7,0.2,0.1))
qqnorm(exercise6_1$"é›¶ä»¶è¯¯å·®",xlab="æœŸæœ›æ­£æ€å€¼",ylab="è§‚æµ‹å€¼",datax=TRUE,main="æ­£æ€Q-Qå›¾")
qqline(exercise6_1$"é›¶ä»¶è¯¯å·®",datax=TRUE,col="red")
```

  åˆ†æï¼šæ ¹æ®Q-Qå›¾å¯ç›´è§‚çœ‹å‡ºï¼Œæœ‰è¾ƒå¤šè§‚æµ‹ç‚¹è¿œç¦»ç›´çº¿ï¼Œæ•…å…¶ä¸æœä»æ­£æ€åˆ†å¸ƒã€‚
  
### æ£€éªŒæ–°æœºåºŠåŠ å·¥çš„é›¶ä»¶å°ºå¯¸çš„å¹³å‡è¯¯å·®ä¸æ—§æœºåºŠç›¸æ¯”æ˜¯å¦æœ‰æ˜¾è‘—é™ä½ï¼ˆÎ±=0.01ï¼‰
```{r}
library(BSDA)
ks.test(exercise6_1$é›¶ä»¶è¯¯å·®,"pnorm", mean(exercise6_1$é›¶ä»¶è¯¯å·®), sd(exercise6_1$é›¶ä»¶è¯¯å·®))
```

  åˆ†æï¼šPå€¼=0.004579ï¼œÎ±=0.01ï¼Œæ‰€ä»¥æ‹’ç»åŸå‡è®¾ï¼Œè®¤ä¸ºç»å¯¹è¯¯å·®æœ‰æ˜¾è‘—é™ä½ã€‚
  
## å®‰è£…äºä¸€ç§è”åˆæ”¶å‰²æœºçš„é‡‘å±æ¿çš„å¹³å‡é‡é‡ä¸º25åƒå…‹ã€‚å¯¹æŸä¼ä¸šç”Ÿäº§çš„20å—é‡‘å±æ¿è¿›è¡Œæµ‹é‡ã€‚å¾—åˆ°çš„é‡é‡æ•°æ®å¦‚ä¸‹ï¼š
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch6/exercise6_2.RData?raw=True")
head(exercise6_2,10)
```

### é‡‡ç”¨Shapiro-Wilkæ£€éªŒå’ŒK-Sæ£€éªŒä¸¤ç§æ–¹æ³•ï¼Œæ£€éªŒè¯¥ä¼ä¸šç”Ÿäº§çš„é‡‘å±æ¿çš„é‡é‡æ˜¯å¦æœä»æ­£æ€åˆ†å¸ƒï¼ˆÎ±=0.05ï¼‰

### Shapiro-Wilkæ£€éªŒ
```{r}
shapiro.test(exercise6_2$é‡é‡)              
```
  
  åˆ†æï¼šHâ‚€ï¼šé‡‘å±æ¿çš„é‡é‡æœä»æ­£æ€åˆ†å¸ƒã€‚Hâ‚ï¼šé‡‘å±æ¿çš„é‡é‡ä¸æœä»æ­£æ€åˆ†å¸ƒï¼Œç»Shapiro-Wilkæ£€éªŒå¯å¾—ï¼ŒW=0.97064,på€¼=0.7684ï¼Œp>0.05,æ‰€ä»¥ä¸èƒ½æ‹’ç»åŸå‡è®¾ï¼Œè®¤ä¸ºé‡‘å±æ¿çš„é‡é‡æœä»æ­£æ€åˆ†å¸ƒã€‚

### K-Sæ£€éªŒ
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch6/exercise6_2.RData?raw=True")
ks.test(exercise6_2$é‡é‡,"pnorm", mean(exercise6_2$é‡é‡), sd(exercise6_2$é‡é‡))
```

  åˆ†æï¼šç»K-Sæ£€éªŒå¯å¾—ï¼ŒD=0.10808ï¼Œpå€¼=0.9539ï¼Œp>0.05,æ‰€ä»¥æ¥å—åŸå‡è®¾ï¼Œè®¤ä¸ºé‡‘å±æ¿çš„é‡é‡æœä»æ­£æ€åˆ†å¸ƒã€‚

### å‡å®šå…¨å±æ¿çš„é‡é‡æœä»æ­£æ€åˆ†å¸ƒï¼Œæ£€éªŒè¯¥ä¼ä¸šç”Ÿäº§çš„é‡‘å±æ¿æ˜¯å¦ç¬¦åˆè¦æ±‚ï¼ˆÎ±=0.05ï¼‰
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch6/exercise6_2.RData?raw=True")
t.test(exercise6_2$é‡é‡,mu = 25)
```

  åˆ†æ:Hâ‚€:é‡‘å±æ¿çš„é‡é‡å¹³å‡æ•°Î¼ï¼25ã€‚Hâ‚ï¼šé‡‘å±æ¿çš„é‡é‡å¹³å‡æ•°Î¼â‰ 25,ç»tæ£€éªŒï¼Œå¾—åˆ°mean of x=25.51,t=-5.627,df=19ï¼Œpå€¼=0.3114ï¼Œp>0.05,æ‹’ç»åŸå‡è®¾ï¼Œæœ‰è¯æ®æ˜¾ç¤ºè¯¥ä¼ä¸šç”Ÿäº§çš„é‡‘å±æ¿ä¸ç¬¦åˆè¦æ±‚ã€‚

### è®¡ç®—æ•ˆåº”é‡ï¼Œåˆ†æå·®å¼‚ç¨‹åº¦ã€‚
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch6/exercise6_2.RData?raw=True")
sd(exercise6_2$é‡é‡)
```

åˆ†æï¼šå¾—åˆ°æ ·æœ¬æ ‡å‡†å·®s=2.193267ï¼Œæ•ˆåº”é‡d=|mean of x-x|/s=0.23252983ï¼Œç»“æœè¡¨ç¤ºï¼šæ ·æœ¬é‡‘å±æ¿çš„å¹³å‡é‡é‡ä¸æ ‡å‡†é‡é‡ç›¸å·®0.23252983ï¼Œå› ä¸º0.20â‰¤d<0.50,ä¸ºå°çš„æ•ˆåº”å€¼ã€‚

## ä¸‹è¡¨æ˜¯æ ·æœ¬ä¸­æ¯ä¸ªäººéƒ½åˆ†åˆ«åœ¨çœ‹è¿‡è¯¥äº§å“çš„æ–°çš„ç”µè§†å¹¿å‘Šä¹‹å‰ä¸ä¹‹åæ‰“åˆ†
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch6/exercise6_3.RData?raw=True")
exercise6_3
```

### ä¸¤ä¸ªæ€»ä½“å‡å€¼ä¹‹å·®çš„å‡è®¾æ£€éªŒ
```{r}
t.test(exercise6_3$çœ‹å , exercise6_3$çœ‹å‰,paired = TRUE,alternative = "greater")
```


  ç»“è®ºï¼šåœ¨è¯¥é¡¹æ£€éªŒä¸­ï¼Œpå€¼=0.1084>0.05,æ‰€ä»¥ä¸èƒ½æ‹’ç»åŸå‡è®¾ï¼Œå³è®¤ä¸ºâ€œçœ‹åâ€å¹³å‡å¾—åˆ†å°äºæˆ–ç­‰äºâ€œçœ‹å‰â€å¹³å‡å¾—åˆ†ã€‚

## ä¸‹è¡¨æ˜¯ä¸¤ç§æ–¹æ³•å¯¹å‘˜å·¥åŸ¹è®­çš„æ•ˆæœå¾—åˆ°çš„æµ‹è¯•åˆ†æ•°ç»“æœçš„æ•°æ®
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch6/exercise6_4.RData?raw=True")
head(exercise6_4,10)
```

### å‡å®šæ–¹å·®ç›¸ç­‰ï¼ˆÎ±=0.05ï¼‰
```{r}
t.test(exercise6_4$æ–¹æ³•1,exercise6_4$æ–¹æ³•2,var.equal = TRUE)
```

  åˆ†æï¼šç”±é…å¯¹æ ·æœ¬tæ£€éªŒï¼ŒHâ‚€:ä¸¤ç§æ–¹æ³•çš„åŸ¹è®­æ•ˆæœæ²¡æœ‰æ˜¾è‘—å·®å¼‚ã€‚Hâ‚:ä¸¤ç§æ–¹æ³•çš„åŸ¹è®­æ•ˆæœæœ‰æ˜¾è‘—å·®å¼‚ã€‚p-value = 2.444e-06<0.05,æ‹’ç»åŸå‡è®¾ï¼Œæ‰€ä»¥è®¤ä¸ºä¸¤ç§æ–¹æ³•çš„åŸ¹è®­æ•ˆæœæœ‰æ˜¾è‘—å·®å¼‚ã€‚

### å‡å®šæ–¹å·®ä¸ç›¸ç­‰
```{r}
t.test(exercise6_4$æ–¹æ³•1,exercise6_4$æ–¹æ³•2,var.equal = FALSE)
```

  ç»“è®ºï¼šç”±é…å¯¹æ ·æœ¬tæ£€éªŒï¼ŒHâ‚€:ä¸¤ç§æ–¹æ³•çš„åŸ¹è®­æ•ˆæœæ²¡æœ‰æ˜¾è‘—å·®å¼‚ã€‚Hâ‚:ä¸¤ç§æ–¹æ³•çš„åŸ¹è®­æ•ˆæœæœ‰æ˜¾è‘—å·®å¼‚ã€‚p-value = 2.568e-06<0.05,æ‹’ç»åŸå‡è®¾ï¼Œæ‰€ä»¥è®¤ä¸ºä¸¤ç§æ–¹æ³•çš„åŸ¹è®­æ•ˆæœæœ‰æ˜¾è‘—å·®å¼‚
  
### è®¡ç®—æ•ˆåº”é‡ï¼Œåˆ†æå·®å¼‚ç¨‹åº¦
```{r}
library(lsr)
cohensD(exercise6_4$æ–¹æ³•1,exercise6_4$æ–¹æ³•2)
```

  ç»“è®ºï¼šæ•ˆåº”é‡:då€¼=2.151704ï¼Œè¡¨ç¤ºæ–¹æ³•1çš„å‡å€¼ï¼ˆğœ‡~1~ï¼‰ä¸æ–¹æ³•2çš„å‡å€¼ï¼ˆğœ‡~2~ï¼‰ç›¸å·®2.151704ä¸ªæ ‡å‡†å·®ï¼Œæ•ˆåº”é‡è¾ƒå¤§ã€‚

## ç”Ÿäº§å•†éšæœºæŠ½å–550äººä½œä¸ºæ ·æœ¬ï¼Œå…¶ä¸­115äººæ—©é¤å–ç‰›å¥¶ï¼ŒéªŒè¯è¯¥åŸå¸‚çš„äººæ—©äº§é¥®ç”¨ç‰›å¥¶çš„æ¯”ä¾‹æ˜¯å¤Ÿé«˜äº17%ã€‚æ£€éªŒè¯¥ç”Ÿäº§å•†çš„è¯´æ³•æ˜¯å¦å±å®ï¼ˆÎ±=0.05ï¼‰
```{r}
n=550
p <- 115/550
pi0=0.17
z <- (p-pi0)/sqrt(pi0*(1-pi0)/n)
p_value <-1-pnorm(z)
data.frame(z,p_value)
```

  ç»“è®º:Hâ‚€: P<=0.17ï¼ŒHâ‚:P>0.17ã€‚æ£€éªŒå¾—p=0.007<0.05ï¼Œæ‹’ç»åŸå‡è®¾ï¼Œè®¤ä¸ºç”Ÿäº§å•†çš„è¯´æ³•å±å®ã€‚

## éšæœºæŠ½å–100å¥³ç»ç†ä¸­æœ‰24äººè®¤ä¸ºè‡ªå·±æˆåŠŸï¼Œ95ç”·ç»ç†ä¸­39äººè®¤ä¸ºè‡ªå·±æˆåŠŸï¼Œæ£€éªŒç”·å¥³è®¤ä¸ºè‡ªå·±æˆåŠŸæ¯”ä¾‹æ˜¯å¦æœ‰æ˜¾è‘—å·®å¼‚ã€‚
```{r}
n1=100
n2=95
p1=0.24
p2=0.41
p=(p1*n1+p2*n2)/(n1+n2)
z=(p1-p2)/sqrt(p*(1-p)*(1/n1+1/n2))
p_value=pnorm(z)
p_value1=2*p_value
data.frame(z, p_value1)
```

  ç»“è®ºï¼šHâ‚€:ç”·å¥³ç»ç†è®¤ä¸ºè‡ªå·±æˆåŠŸçš„äººæ•°æ— æ˜¾è‘—å·®å¼‚ï¼ŒHâ‚:ç”·å¥³ç»ç†è®¤ä¸ºè‡ªå·±æˆåŠŸçš„äººæ•°æœ‰æ˜¾è‘—å·®å¼‚ã€‚p<0.05,æ‹’ç»åŸå‡è®¾ï¼Œå³è®¤ä¸ºç”·å¥³ç»ç†è®¤ä¸ºè‡ªå·±æˆåŠŸçš„äººæ•°æœ‰æ˜¾è‘—å·®å¼‚ã€‚

## åœŸå£¤ç›¸åŒ40å—åœ°ï¼Œå„20å—ç”¨æ–°æ—§ä¸¤ç§è‚¥æ–™å¾—åˆ°çš„äº§é‡è¡¨
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch6/exercise6_7.RData?raw=True")
head(exercise6_7,10)
```
### æ–°è‚¥æ–™å¹³å‡äº§é‡æ˜¯å¦æ˜¾è‘—é«˜äºæ—§è‚¥æ–™ï¼Œæ–¹å·®ç›¸ç­‰å‰æä¸‹ã€‚
```{r}
t.test(exercise6_7$æ–°è‚¥æ–™,exercise6_7$æ—§è‚¥æ–™,var.equal=TRUE,alternative="greater")
```

  ç»“è®ºï¼šHâ‚€:ä½¿ç”¨æ–°è‚¥æ–™çš„äº§é‡å‡å€¼â‰¤ä½¿ç”¨æ—§è‚¥æ–™äº§é‡å‡å€¼ï¼ŒHâ‚:ä½¿ç”¨æ–°è‚¥æ–™çš„äº§é‡çš„å‡å€¼>ä½¿ç”¨æ—§è‚¥æ–™äº§é‡å‡å€¼ã€‚p=1.737e-06<0.05ï¼Œæ‹’ç»åŸå‡è®¾ï¼Œç»Ÿè®¡æ„ä¹‰ä¸Šè®¤ä¸ºæ–°è‚¥æ–™äº§é‡æ˜é«˜äºäºæ—§è‚¥æ–™äº§é‡ï¼Œæ‰€ä»¥åº”è¯¥ä½¿ç”¨æ–°è‚¥æ–™ã€‚


### ä¸¤ç§è‚¥æ–™äº§é‡æ–¹å·®æ˜¯å¦æœ‰æ˜¾è‘—å·®å¼‚
```{r}
var.test(exercise6_7[,1],exercise6_7[,2])
```

  ç»“è®ºï¼šHâ‚€:ä¸¤ç§è‚¥æ–™äº§é‡çš„æ–¹å·®æ— æ˜¾è‘—å·®å¼‚ï¼ŒHâ‚ä¸¤ç§è‚¥æ–™äº§é‡çš„æ–¹å·®æœ‰æ˜¾è‘—å·®å¼‚ã€‚æ ¹æ®æ£€éªŒp=0.4862>0.05ï¼Œä¸èƒ½æ‹’ç»åŸå‡è®¾ï¼Œè®¤ä¸ºä¸¤ç§è‚¥æ–™äº§é‡çš„æ–¹å·®æ— æ˜¾è‘—æ€§å·®å¼‚ã€‚
  
### è®¡ç®—æ•ˆåº”é‡ï¼Œåˆ†æå·®å¼‚ç¨‹åº¦ã€‚
```{r}
library(lsr)
 cohensD(exercise6_7$æ—§è‚¥æ–™,exercise6_7$æ–°è‚¥æ–™)
```

  ç»“è®ºï¼šæ–°è‚¥æ–™ä¸æ—§è‚¥æ–™çš„æ•ˆåº”é‡ä¸º1.716202ï¼Œå³æ–°è‚¥æ–™ä¸æ—§è‚¥æ–™å‡å€¼ç›¸å·® 1.716202ä¸ªæ ‡å‡†å·®ï¼Œæ•ˆåº”é‡è¾ƒå¤§ã€‚
  
## ç”Ÿäº§å·¥åºä¸­çš„æ–¹å·®æ˜¯å·¥åºè´¨é‡çš„ä¸€ä¸ªé‡è¦æŒ‡æ ‡ã€‚é€šå¸¸è¾ƒå¤§çš„æ–¹å·®å°±æ„å‘³ç€è¦é€šè¿‡å¯»æ‰¾å‡å°å·¥åºæ–¹å·®çš„é€”å¾„æ¥æ”¹è¿›å·¥ä½œã€‚æŸæ‚å¿—ä¸ŠåˆŠè½½äº†ä¸¤å°æœºå™¨ç”Ÿäº§çš„è¢‹èŒ¶é‡é‡çš„æ•°æ®ï¼ˆå•ä½ï¼šå…‹ï¼‰å¦‚ä¸‹ï¼šæ£€éªŒè¿™ä¸¤éƒ¨æœºå™¨ç”Ÿäº§çš„è¢‹èŒ¶é‡é‡çš„æ–¹å·®æ˜¯å¦å­˜åœ¨æ˜¾è‘—å·®å¼‚ï¼ˆÉ‘=0.05ï¼‰ã€‚
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch6/exercise6_8.RData?raw=True")
var.test(exercise6_8[,1],exercise6_8[,2],alternative="two.sided")
```

  ç»“è®ºï¼šç”±ä¸¤ä¸ªæ€»ä½“çš„æ–¹å·®æ£€éªŒï¼ŒHâ‚€:ä¸¤æœºå™¨ç”Ÿäº§çš„è¢‹èŒ¶é‡é‡çš„çš„æ–¹å·®æ— æ˜¾è‘—å·®å¼‚.Hâ‚ï¼šä¸¤æœºå™¨ç”Ÿäº§çš„è¢‹èŒ¶é‡é‡çš„çš„æ–¹å·®æœ‰æ˜¾è‘—å·®å¼‚ã€‚på€¼=1.477e-06<0.05.æ‹’ç»åŸå‡è®¾ï¼Œå³è®¤ä¸ºä¸¤æœºå™¨ç”Ÿäº§çš„è¢‹èŒ¶é‡é‡çš„çš„æ–¹å·®æœ‰æ˜¾è‘—å·®å¼‚ã€‚

## ä¸ºäº†è§£ä¸€ç§èŠ‚èƒ½ç¯çš„ä½¿ç”¨å¯¿å‘½ï¼ŒéšæœºæŠ½å–äº†10åªç¯æ³¡ï¼Œæµ‹å¾—å…¶ä½¿ç”¨å¯¿å‘½ï¼ˆå•ä½ï¼šå°æ—¶ï¼‰å¦‚ä¸‹ï¼šé‡‡ç”¨Wilcoxonç¬¦å·ç§©æ£€éªŒæ£€éªŒè¯¥ç§èŠ‚èƒ½ç¯ä½¿ç”¨å¯¿å‘½çš„ä¸­ä½æ•°æ˜¯å¦ç­‰äº6000å°æ—¶ï¼ˆÉ‘=0.05ï¼‰ã€‚
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch6/exercise6_9.RData?raw=True")
 wilcox.test(exercise6_9$å¯¿å‘½,m = 6000)
```

  ç»“è®ºï¼šç”±Wilcoxonç¬¦å·ç§©æ£€éªŒï¼ŒHâ‚€:ä½¿ç”¨å¯¿å‘½çš„ä¸­ä½æ•°ç­‰äº6000ã€‚Hâ‚:ä½¿ç”¨å¯¿å‘½çš„ä¸­ä½æ•°ä¸ç­‰äº6000ã€‚på€¼=0.1934>0.05ï¼Œå› æ­¤ä¸èƒ½æ‹’ç»åŸå‡è®¾ï¼Œå³è®¤ä¸ºä½¿ç”¨å¯¿å‘½çš„ä¸­ä½æ•°çš„ç­‰äº6000.
  
## æŸç§å“ç‰Œçš„å½©ç”µåœ¨ä¸¤ä¸ªåŸå¸‚é”€å”®ï¼Œåœ¨AåŸå¸‚å’ŒBåŸå¸‚å„æœ‰8ä¸ªå•†åœºé”€å”®ã€‚ä¸‹è¡¨æ˜¯å„å•†åœºä¸€å¹´çš„é”€å”®é‡ï¼ˆå•ä½ï¼šå°ï¼‰ã€‚é‡‡ç”¨Mann-Whitneyæ£€éªŒåˆ†æä¸¤ä¸ªåŸå¸‚çš„é”€å”®é‡æ˜¯å¦æœ‰æ˜¾è‘—å·®å¼‚ï¼ˆÉ‘=0.05ï¼‰ã€‚
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch6/exercise6_10.RData?raw=True")
 attach(exercise6_10)
 wilcox.test(AåŸå¸‚,BåŸå¸‚)
```

  ç»“è®ºï¼šç”±Mann-Whitneyæ£€éªŒï¼ŒHâ‚€:ä¸¤ä¸ªåŸå¸‚çš„é”€å”®é‡æ— æ˜¾è‘—å·®å¼‚ã€‚Hâ‚ï¼šä¸¤ä¸ªåŸå¸‚çš„é”€å”®é‡ç”±æ˜¾è‘—å·®å¼‚ã€‚på€¼=0.5992>0.05ï¼Œä¸èƒ½æ‹’ç»åŸå‡è®¾ï¼Œå³è®¤ä¸ºä¸¤ä¸ªåŸå¸‚çš„é”€å”®é‡æ— æ˜¾è‘—å·®å¼‚

## ä¸ºåˆ†æè‚¡ç¥¨çš„æ¯è‚¡ç›ˆåˆ©çŠ¶å†µï¼Œåœ¨æŸè¯åˆ¸å¸‚åœºä¸ŠéšæœºæŠ½å–10åªè‚¡ç¥¨ï¼Œå¾—åˆ°ä¸Šå¹´åº¦å’Œæœ¬å¹´åº¦çš„æ¯è‚¡ç›ˆåˆ©ï¼ˆå•ä½ï¼šå…ƒï¼‰æ•°æ®å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼Œé‡‡ç”¨Wilcoxonç¬¦å·ç§©æ£€éªŒåˆ†æï¼šæœ¬å¹´åº¦ä¸ä¸Šå¹´åº¦ç›¸æ¯”ï¼Œæ¯è‚¡ç›ˆåˆ©æ˜¯å¦æœ‰æ˜¾è‘—æé«˜ï¼ˆÉ‘=0.05ï¼‰ã€‚
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch6/exercise6_11.RData?raw=True")
 attach(exercise6_11)
 wilcox.test(ä¸Šå¹´åº¦,æœ¬å¹´åº¦,paired=TRUE)
```

  ç»“è®ºï¼šç”±ä¸¤ä¸ªé…å¯¹æ ·æœ¬çš„Wilcoxonç¬¦å·ç§©æ£€éªŒï¼ŒHâ‚€:æœ¬å¹´åº¦ä¸ä¸Šå¹´åº¦ç›¸æ¯”ï¼Œæ¯è‚¡ç›ˆåˆ©æ— æ˜¾è‘—æé«˜ï¼›Hâ‚:æœ¬å¹´åº¦ä¸ä¸Šå¹´åº¦ç›¸æ¯”ï¼Œæ¯è‚¡ç›ˆåˆ©æœ‰æ˜¾è‘—æé«˜ã€‚ç”±SPSSçš„Wilcoxonç¬¦å·ç§©æ£€éªŒï¼ŒÎ±=0.05ï¼Œå¾—åˆ°på€¼=0.08293ã€‚p/2=0.041465<0.05,æ‹’ç»åŸå‡è®¾ï¼Œå³è®¤ä¸ºæœ¬å¹´åº¦ä¸ä¸Šå¹´åº¦ç›¸æ¯”ï¼Œæ¯è‚¡ç›ˆåˆ©æœ‰æ˜¾è‘—æé«˜ã€‚

# ç¬¬ä¸ƒç«  ç±»åˆ«å˜é‡åˆ†æ
## ä¸€å®¶é£Ÿå“ç”Ÿäº§ä¼ä¸šæƒ³äº†è§£è¿‡å»ä¸€å¹´ä¸­å„ä¸ªæœˆä»½çš„é”€å”®é‡æ˜¯å¦ç¬¦åˆå‡åŒ€åˆ†å¸ƒï¼Œä»¥ä¾¿æ›´å¥½åœ°å®‰æ’ç”Ÿäº§ã€‚ä¼ä¸šçš„å¸‚åœºé”€å”®éƒ¨é—¨æ”¶é›†çš„è¿‡å»ä¸€å¹´ä¸­æ¯ä¸ªæœˆçš„é”€å”®é‡æ•°æ®å¦‚ä¸‹ï¼š
 æ£€éªŒå„ä¸ªæœˆä»½çš„é”€å”®é‡æ˜¯å¦ç¬¦åˆå‡åŒ€åˆ†å¸ƒï¼ˆÎ±=0.05ï¼‰
 Hâ‚€ï¼šå„ä¸ªæœˆä»½çš„é”€å”®é‡ç¬¦åˆå‡åŒ€åˆ†å¸ƒ 
 Hâ‚ï¼šå„ä¸ªæœˆä»½çš„é”€å”®é‡ä¸ç¬¦åˆå‡åŒ€åˆ†å¸ƒ
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch7/exercise7_1.RData?raw=True")
exercise7_1
chisq.test(exercise7_1$é”€å”®é‡)
```


 p-value=9.778e-13<0.05,åˆ™æ‹’ç»åŸå‡è®¾ï¼Œç»Ÿè®¡æ„ä¹‰ä¸Šè®¤ä¸ºå„ä¸ªæœˆä»½çš„é”€å”®é‡ä¸ç¬¦åˆå‡åŒ€åˆ†å¸ƒã€‚

## ä¸ºç ”ç©¶å¤§å­¦ç”Ÿçš„é€ƒè¯¾æƒ…å†µï¼Œä¸€ä¸ªç ”ç©¶å°ç»„åšäº†ä¸€æ¬¡è°ƒæŸ¥ï¼Œå¾—åˆ°ç”·å¥³ç”Ÿé€ƒè¯¾æƒ…å†µçš„æ±‡æ€»è¡¨å¦‚ä¸‹ï¼šæ£€éªŒæ˜¯å¦é€ƒè¯¾ä¸å­¦ç”Ÿæ€§åˆ«æ˜¯å¦ç‹¬ç«‹ï¼ˆÎ±=0.05ï¼‰
 Hâ‚€ï¼šæ˜¯å¦é€ƒè¯¾ä¸å­¦ç”Ÿæ€§åˆ«ç‹¬ç«‹ 
 Hâ‚ï¼šæ˜¯å¦é€ƒè¯¾ä¸å­¦ç”Ÿæ€§åˆ«ä¸ç‹¬ç«‹
```{r}
x<-c(34,28,38,50) 
M<-matrix(x,nr=2,nc=2,byrow=TRUE,dimnames=list(c("ç”·","å¥³"),c("é€ƒè¿‡è¯¾","æ²¡é€ƒè¿‡è¯¾")))
chisq.test(M)
```
 p-value=0.2145ï¼0.05,æ•…ä¸èƒ½æ‹’ç»åŸå‡è®¾ï¼Œå³ä¸èƒ½è®¤ä¸ºæ˜¯å¦é€ƒè¯¾ä¸å­¦ç”Ÿæ€§åˆ«ä¸ç‹¬ç«‹ã€‚

## ä¸ºç ”ç©¶ä¸Šå¸‚å…¬å¸å¯¹å…¶è‚¡ä»·æ³¢åŠ¨çš„å…³æ³¨ç¨‹åº¦ï¼Œä¸€å®¶ç ”ç©¶æœºæ„å¯¹åœ¨ä¸»æ¿ã€ä¸­å°æ¿ã€åˆ›ä¸šæ¿ä¸Šå¸‚çš„190å®¶å…¬å¸è¿›è¡Œäº†è°ƒæŸ¥ï¼Œæ£€éªŒä¸Šå¸‚å…¬å¸çš„ç±»å‹ä¸å¯¹è‚¡ä»·æ³¢åŠ¨çš„å…³æ³¨ç¨‹åº¦æ˜¯å¦ç‹¬ç«‹ã€‚
```{r}
x<-c(50,70,30,15,20,5) 
M<-matrix(x,nr=3,nc=2,byrow=TRUE,dimnames=list(c("ä¸»æ¿ä¼ä¸š","ä¸­å°æ¿ä¼ä¸š","åˆ›ä¸šæ¿ä¼ä¸š"),c("å…³æ³¨","ä¸å…³æ³¨")))
M
chisq.test(M)
```
 Hâ‚€ï¼šä¸Šå¸‚å…¬å¸çš„ç±»å‹ä¸å¯¹è‚¡ä»·æ³¢åŠ¨çš„å…³æ³¨ç¨‹åº¦ç‹¬ç«‹

 Hâ‚ï¼šä¸Šå¸‚å…¬å¸çš„ç±»å‹ä¸å¯¹è‚¡ä»·æ³¢åŠ¨çš„å…³æ³¨ç¨‹åº¦ä¸ç‹¬ç«‹

 ç”±æ£€éªŒç»“æœå¯çŸ¥p-value = 0.0002189<0.05ï¼Œæ‹’ç»Hâ‚€ï¼Œè®¤ä¸ºä¸Šå¸‚å…¬å¸çš„ç±»å‹ä¸å¯¹è‚¡ä»·æ³¢åŠ¨çš„å…³æ³¨ç¨‹åº¦ä¸ç‹¬ç«‹ã€‚

## ä¸€å®¶æ±½è½¦ä¼ä¸šçš„é”€å”®éƒ¨é—¨å¯¹åŒ—éƒ¨åœ°åŒºã€ä¸­éƒ¨åœ°åŒºå’Œå—éƒ¨åœ°åŒºçš„400ä¸ªæ¶ˆè´¹è€…åšäº†æŠ½çƒŸè°ƒæŸ¥ï¼Œæ£€éªŒåœ°åŒºä¸æ±½è½¦ä»·æ ¼æ˜¯å¦ç‹¬ç«‹ã€‚
```{r}
y<-c(20,40,40,50,50,60,30,20,20,40,10,20) 
N<-matrix(y,nr=4,nc=3,byrow=TRUE,dimnames=list(c("10ä¸‡å…ƒä»¥ä¸‹","10ä¸‡~20ä¸‡å…ƒ","20~30ä¸‡å…ƒ","30ä¸‡å…ƒä»¥ä¸Š"),c("åŒ—éƒ¨åœ°åŒº","å—éƒ¨åœ°åŒº","ä¸­éƒ¨åœ°åŒº")))
N
chisq.test(N)
```
 Hâ‚€ï¼šåœ°åŒºä¸æ±½è½¦ä»·æ ¼ç‹¬ç«‹

 Hâ‚ï¼šåœ°åŒºä¸æ±½è½¦ä»·æ ¼ä¸ç‹¬ç«‹

 ç”±æ£€éªŒç»“æœå¯çŸ¥p-value = 3.946e-05<0.05ï¼Œæ‹’ç»Hâ‚€ï¼Œè®¤ä¸ºåœ°åŒºä¸æ±½è½¦ä»·æ ¼ä¸ç‹¬ç«‹ã€‚

## è®¡ç®—ä¹ é¢˜7.3ä¸­ä¸Šå¸‚å…¬å¸çš„ç±»å‹å¯¹è‚¡ä»·æ³¢åŠ¨çš„å…³æ³¨ç¨‹åº¦ä¸¤ä¸ªå˜é‡ä¹‹é—´çš„phiç³»æ•°ã€Crammer'sç³»æ•°å’Œåˆ—è”ç³»æ•°ï¼Œå¹¶åˆ†æå…¶ç›¸å…³ç¨‹åº¦ã€‚
```{r}
library(vcd)
x=c(50,70,30,15,20,5)
M=matrix(x,nrow=3,ncol=2,byrow=T,dimnames=list(c("ä¸»æ¿ä¼ä¸š","ä¸­å°æ¿ä¼ä¸š","åˆ›ä¸šæ¿ä¼ä¸š"),c("å…³æ³¨","ä¸å…³æ³¨")))
M
assocstats(M)
```
 åˆ†æï¼šphiç³»æ•°åªç”¨äº2*2åˆ—è”è¡¨ï¼Œæ•…æ²¡æœ‰ç»“æœã€‚Crammer'sç³»æ•°V=0.298ï¼Œåˆ—è”ç³»æ•°C=0.298ï¼Œè¡¨æ˜ä¸Šå¸‚å…¬å¸çš„ç±»å‹ä¸å¯¹è‚¡ä»·æ³¢åŠ¨çš„å…³æ³¨ç¨‹åº¦æœ‰ä¸€å®šçš„ç›¸å…³æ€§ã€‚

## è®¡ç®—ä¹ é¢˜7.4ä¸­åœ°åŒºä¸æ±½è½¦ä»·æ ¼ä¸¤ä¸ªå˜é‡ä¹‹é—´çš„phiç³»æ•°ã€Crammer'sç³»æ•°å’Œåˆ—è”ç³»æ•°ï¼Œå¹¶åˆ†æå…¶ç›¸å…³ç¨‹åº¦ã€‚
```{r}
library(vcd)
y<-c(20,40,40,50,50,60,30,20,20,40,10,20) 
N<-matrix(y,nr=4,nc=3,byrow=TRUE,dimnames=list(c("10ä¸‡å…ƒä»¥ä¸‹","10ä¸‡~20ä¸‡å…ƒ","20~30ä¸‡å…ƒ","30ä¸‡å…ƒä»¥ä¸Š"),c("åŒ—éƒ¨åœ°åŒº","å—éƒ¨åœ°åŒº","ä¸­éƒ¨åœ°åŒº")))
N
assocstats(N)
```

 åˆ†æï¼šphiç³»æ•°åªç”¨äº2*2åˆ—è”è¡¨ï¼Œæ•…æ²¡æœ‰ç»“æœã€‚Crammer'sç³»æ•°V=0.194ï¼Œåˆ—è”ç³»æ•°C=0.264ï¼Œè¡¨æ˜ä¸Šå¸‚å…¬å¸çš„ç±»å‹ä¸å¯¹è‚¡ä»·æ³¢åŠ¨çš„å…³æ³¨ç¨‹åº¦æœ‰ä¸€å®šçš„ç›¸å…³æ€§ã€‚


# ç¬¬å…«ç«  æ–¹å·®åˆ†æ

## ä¸€å®¶ç‰›å¥¶å…¬å¸æœ‰4å°æœºå™¨è£…å¡«ç‰›å¥¶,æ¯æ¡¶çš„å®¹é‡ä¸º4L

### æ£€éªŒæœºå™¨å¯¹è£…å¡«é‡æ˜¯å¦æœ‰æ˜¾è‘—æ€§å½±å“ã€‚
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch8/exercise8_1.RData?raw=True")
head(exercise8_1,10)
attach(exercise8_1)
model_1w<-aov(å¡«è£…é‡~æœºå™¨)
summary(model_1w)
model_1w$coefficients
```

 Hâ‚€:æœºå™¨å¯¹è£…å¡«é‡çš„å½±å“ä¸æ˜¾è‘—
 Hâ‚:æœºå™¨å¯¹è£…å¡«é‡çš„å½±å“æ˜¾è‘—
 ç”±åˆ†æç»“æœå¯çŸ¥ï¼Œp=0.0135>0.01ï¼Œä¸æ‹’ç»Hâ‚€ï¼Œå³ä¸èƒ½è®¤ä¸ºæœºå™¨å¯¹è£…å¡«é‡çš„å½±å“æ˜¾è‘—ã€‚

### åˆ†ææ•ˆåº”é‡ã€‚
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch8/exercise8_1.RData?raw=True")
attach(exercise8_1)
library(DescTools)
model_1w<-aov(å¡«è£…é‡~æœºå™¨)
EtaSq(model_1w,anova=T)
```

 ç”±æ•ˆåº”é‡ç»“æœ$\eta^2$=0.4070206å¯çŸ¥ï¼Œç»„é—´å·®å¼‚è¾ƒå¤§ã€‚

### åˆ†åˆ«é‡‡ç”¨LSDæ–¹æ³•å’ŒHSDæ–¹æ³•æ¯”è¾ƒå“ªäº›æœºå™¨çš„è£…å¡«é‡ä¹‹é—´å­˜åœ¨æ˜¾è‘—å·®å¼‚ã€‚
```{r}
library(DescTools)
PostHocTest(model_1w,method="lsd")
```

 Hâ‚€ï¼š$n_i$=$n_j$
 Hâ‚ï¼š$n_i$â‰ $n_j$
 ç”±LSDåˆ†æç»“æœå¯çŸ¥ï¼š                                 
 æœºå™¨2-æœºå™¨1çš„p-value=0.2225>0.05,ä¸æ‹’ç»Hâ‚€ï¼Œå³ä¸èƒ½è®¤ä¸ºæœºå™¨2ä¸æœºå™¨1ä¹‹é—´æœ‰æ˜¾è‘—å·®å¼‚ï¼›        

 æœºå™¨3-æœºå™¨1çš„p-value=0.0016<0.05,æ‹’ç»Hâ‚€,è®¤ä¸ºæœºå™¨3ä¸æœºå™¨1ä¹‹é—´æœ‰æ˜¾è‘—å·®å¼‚ï¼›                  

 æœºå™¨4-æœºå™¨1çš„p-value=0.1772>0.05,ä¸æ‹’ç»Hâ‚€ï¼Œå³ä¸èƒ½è®¤ä¸ºæœºå™¨4ä¸æœºå™¨1ä¹‹é—´æœ‰æ˜¾è‘—å·®å¼‚ï¼›           
 æœºå™¨3-æœºå™¨2çš„p-value=0.0275<0.05,æ‹’ç»Hâ‚€,è®¤ä¸ºæœºå™¨3ä¸æœºå™¨2ä¹‹é—´æœ‰æ˜¾è‘—å·®å¼‚ï¼›    

 æœºå™¨4-æœºå™¨2çš„p-value=0.8901>0.05,ä¸æ‹’ç»Hâ‚€ï¼Œå³ä¸èƒ½è®¤ä¸ºæœºå™¨4ä¸æœºå™¨2ä¹‹é—´æœ‰æ˜¾è‘—å·®å¼‚ï¼›           
 æœºå™¨4-æœºå™¨3çš„p-value=0.0367<0.05,æ‹’ç»Hâ‚€,è®¤ä¸ºæœºå™¨4ä¸æœºå™¨3ä¹‹é—´æœ‰æ˜¾è‘—å·®å¼‚ï¼›

```{r}
PostHocTest(model_1w,method="hsd")
```

 Hâ‚€:$n_i$=$n_j$
 Hâ‚:$n_i$â‰ $n_j$

 ç”±HSDåˆ†æç»“æœå¯çŸ¥ï¼š

 æœºå™¨2-æœºå™¨1çš„p-value=0.5982>0.05,ä¸æ‹’ç»Hâ‚€ï¼Œå³ä¸èƒ½è®¤ä¸ºæœºå™¨2ä¸æœºå™¨1ä¹‹é—´æœ‰æ˜¾è‘—å·®å¼‚ï¼›

 æœºå™¨3-æœºå™¨1çš„p-value=0.0082<0.05,æ‹’ç»Hâ‚€,è®¤ä¸ºæœºå™¨3ä¸æœºå™¨1ä¹‹é—´æœ‰æ˜¾è‘—å·®å¼‚ï¼›   

 æœºå™¨4-æœºå™¨1çš„p-value=0.5144>0.05,ä¸æ‹’ç»Hâ‚€ï¼Œå³ä¸èƒ½è®¤ä¸ºæœºå™¨4ä¸æœºå™¨1ä¹‹é—´æœ‰æ˜¾è‘—å·®å¼‚ï¼›           
 æœºå™¨3-æœºå™¨2çš„p-value=0.1140>0.05,ä¸æ‹’ç»Hâ‚€ï¼Œå³ä¸èƒ½è®¤ä¸ºæœºå™¨3ä¸æœºå™¨2ä¹‹é—´æœ‰æ˜¾è‘—å·®å¼‚ï¼›           
 æœºå™¨4-æœºå™¨2çš„p-value=0.9990>0.05,ä¸æ‹’ç»Hâ‚€ï¼Œå³ä¸èƒ½è®¤ä¸ºæœºå™¨4ä¸æœºå™¨2ä¹‹é—´æœ‰æ˜¾è‘—å·®å¼‚ï¼›           
 æœºå™¨4-æœºå™¨3çš„p-value=0.1471>0.05,ä¸æ‹’ç»Hâ‚€ï¼Œå³ä¸èƒ½è®¤ä¸ºæœºå™¨4ä¸æœºå™¨3ä¹‹é—´æœ‰æ˜¾è‘—å·®å¼‚ï¼›


### æ£€éªŒè£…å¡«é‡æ˜¯å¦æ»¡è¶³æ­£æ€æ€§å’Œæ–¹å·®é½æ€§ã€‚
### shapiroæ­£æ€æ€§æ£€éªŒ
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch8/exercise8_1.RData?raw=True")
attach(exercise8_1)
shapiro.test(å¡«è£…é‡)
```

 Hâ‚€ï¼šå¡«è£…é‡æœä»æ­£æ€åˆ†å¸ƒ
 Hâ‚ï¼šå¡«è£…é‡ä¸æœä»æ­£æ€åˆ†å¸ƒ
 ç”±shapiroæ­£æ€æ€§æ£€éªŒå¯çŸ¥ï¼Œp-value = 0.7912>0.05,ä¸æ‹’ç»Hâ‚€,å¯ä»¥è®¤ä¸ºå¡«è£…é‡æœä»æ­£æ€åˆ†å¸ƒã€‚


### Batrlett-æ£€éªŒ
```{r}
bartlett.test(å¡«è£…é‡~æœºå™¨,data=exercise8_1)
```

 Hâ‚€:å„ä¸ªæ€»ä½“æ–¹å·®ç›¸åŒ
 Hâ‚:æ‰€æœ‰æ€»ä½“æ–¹å·®ä¸­è‡³å°‘ä¸¤ä¸ªæ–¹å·®ä¸åŒ
 ç”±Batrlett-æ–¹å·®é½æ€§æ£€éªŒå¯çŸ¥ï¼Œp-value = 0.7073>0.05ï¼Œä¸æ‹’ç»Hâ‚€ï¼Œå¯ä»¥è®¤ä¸ºå„ä¸ªæ€»ä½“æ–¹å·®ç›¸åŒã€‚

## ä¸€å®¶ç®¡ç†å’¨è¯¢å…¬å¸ä¸ºä¸åŒçš„å®¢æˆ·ä¸¾åŠäººåŠ›èµ„æºç®¡ç†è®²åº§ã€‚æ¯æ¬¡è®²åº§çš„å†…å®¹åŸºæœ¬ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œä½†è®²åº§çš„å¬è¯¾è€…ï¼Œæœ‰æ—¶æ˜¯é«˜çº§ç®¡ç†è€…ï¼Œæœ‰æ—¶æ˜¯ä¸­çº§ç®¡ç†è€…ï¼Œæœ‰æ—¶æ˜¯ä½çº§ç®¡ç†è€…ã€‚è¯¥å’¨è¯¢å…¬å¸è®¤ä¸ºï¼Œä¸åŒå±‚æ¬¡çš„ç®¡ç†è€…å¯¹è®²åº§çš„æ»¡æ„åº¦æ˜¯ä¸åŒçš„ï¼Œå¯¹å¬å®Œè®²åº§åéšæœºæŠ½å–çš„ä¸åŒå±‚æ¬¡ç®¡ç†è€…çš„æ»¡æ„åº¦è¯„åˆ†å¦‚ä¸‹ï¼ˆè¯„åˆ†æ ‡å‡†ä»1â€”â€”10ï¼Œ10ä»£è¡¨éå¸¸æ»¡æ„ï¼‰ï¼š
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch8/exercise8_2.RData?raw=True")
exercise8_2
```
### æ£€éªŒç®¡ç†è€…çš„æ°´å¹³ä¸åŒæ˜¯å¦ä¼šå¯¼è‡´è¯„åˆ†çš„æ˜¾è‘—å·®å¼‚ï¼ˆÎ±=0.05ï¼‰ï¼Œå¹¶åˆ†ææ•ˆåº”é‡ã€‚
 Hâ‚€ï¼šç®¡ç†è€…çš„æ°´å¹³ä¸åŒä¸ä¼šå¯¼è‡´è¯„åˆ†çš„æ˜¾è‘—å·®å¼‚
 Hâ‚ï¼šç®¡ç†è€…çš„æ°´å¹³ä¸åŒä¼šå¯¼è‡´è¯„åˆ†çš„æ˜¾è‘—å·®å¼‚
```{r}
attach(exercise8_2)
model_1w<-aov(è¯„åˆ†~ç®¡ç†è€…)
summary(model_1w)
```

 p-value = 0.000633<0.05,åˆ™æ‹’ç»Hâ‚€ï¼Œè®¤ä¸ºç®¡ç†è€…çš„æ°´å¹³ä¸åŒä¼šå¯¼è‡´è¯„åˆ†çš„æ˜¾è‘—å·®å¼‚ã€‚
```{r}
library(DescTools)
attach(exercise8_2)
model_1w<-aov(è¯„åˆ†~ç®¡ç†è€…)
EtaSq(model_1w,anova=T)
```
 æ•ˆåº”é‡= 0.6254296ï¼Œåˆ™è¡¨æ˜ç»„é—´å·®å¼‚è¾ƒå¤§

### åˆ†åˆ«é‡‡ç”¨LSDæ–¹æ³•å’ŒHSDæ–¹æ³•æ¯”è¾ƒç®¡ç†è€…ä¹‹é—´è¯„åˆ†çš„å·®å¼‚
```{r}
library(agricolae)
model_1w<-aov(è¯„åˆ†~ç®¡ç†è€…,data=exercise8_2)
LSD<-LSD.test(model_1w,"ç®¡ç†è€…");LSD
```
 ç»“æœæ˜¾ç¤ºå¦‚ä¸‹ï¼š
 ä¸­å±‚ç®¡ç†è€… 9.000000      a
 é«˜å±‚ç®¡ç†è€… 7.666667      a
 ä½å±‚ç®¡ç†è€… 5.833333      b
 è®¤ä¸ºä¸­å±‚ç®¡ç†è€…å’Œé«˜å±‚ç®¡ç†è€…ä¹‹é—´å·®å¼‚ä¸æ˜¾è‘—ï¼Œä½å±‚ç®¡ç†è€…å’Œä¸­å±‚ç®¡ç†è€…ã€ä½å±‚ç®¡ç†è€…å’Œé«˜å±‚ç®¡ç†è€…ä¹‹é—´å·®å¼‚æ˜¾è‘—ã€‚
```{r}
library(agricolae)
HSD<-HSD.test(model_1w,"ç®¡ç†è€…");HSD
```
 åˆ†æï¼šè®¤ä¸ºä¸­å±‚ç®¡ç†è€…å’Œé«˜å±‚ç®¡ç†è€…ä¹‹é—´å·®å¼‚ä¸æ˜¾è‘—ï¼Œä½å±‚ç®¡ç†è€…å’Œä¸­å±‚ç®¡ç†è€…ã€ä½å±‚ç®¡ç†è€…å’Œé«˜å±‚ç®¡ç†è€…ä¹‹é—´å·®å¼‚æ˜¾è‘—ã€‚

### æ£€éªŒæ»¡æ„åº¦è¯„åˆ†æ˜¯å¦æ»¡è¶³æ­£æ€æ€§å’Œæ–¹å·®é½æ€§ã€‚
### æ­£æ€æ€§ï¼š
 Hâ‚€ï¼šæ€»ä½“æ»¡è¶³æ­£æ€åˆ†å¸ƒ
 Hâ‚ï¼šæ€»ä½“ä¸æ»¡è¶³æ­£æ€åˆ†å¸ƒ
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch8/exercise8_2.RData?raw=True")
attach(exercise8_2)
shapiro.test(è¯„åˆ†)
```
 p-value = 0.3063>0.05,åˆ™ä¸èƒ½æ‹’ç»åŸå‡è®¾ï¼Œè®¤ä¸ºæ€»ä½“æ»¡è¶³æ­£æ€åˆ†å¸ƒã€‚
### æ–¹å·®é½æ€§
 Hâ‚€ï¼š$\sigma_1^2$=$\sigma_2^2$=â‹¯=$\sigma_I^2$
 Hâ‚ï¼š$\sigma_1^2$ã€$\sigma_2^2$ã€â‹¯ã€$\sigma_I^2$è‡³å°‘ä¸¤ä¸ªæ–¹å·®ä¸åŒ
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch8/exercise8_2.RData?raw=True")
library(car)
leveneTest(è¯„åˆ†~ç®¡ç†è€…,exercise8_2)
```
 p-value =0.2857>0.05ï¼Œåˆ™ä¸æ‹’ç»Hâ‚€ï¼Œè®¤ä¸ºæ»¡æ„åº¦è¯„åˆ†æ»¡è¶³æ–¹å·®é½æ€§


### å‡å®šä¸åŒå±‚æ¬¡ç®¡ç†è€…çš„æ»¡æ„åº¦è¯„åˆ†ä¸æ»¡è¶³æ–¹å·®åˆ†æçš„å‡å®šã€‚é‡‡ç”¨Kruskal-Wallisæ£€éªŒè¿›è¡Œåˆ†æã€‚
 Hâ‚€:æ‰€æœ‰æ€»ä½“éƒ½ç›¸åŒ
 Hâ‚:å¹¶éæ‰€æœ‰æ€»ä½“éƒ½ç›¸åŒ
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch8/exercise8_2.RData?raw=True")
attach(exercise8_2)
kruskal.test(è¯„åˆ†~ç®¡ç†è€…)
```
 p-value = 0.004623<0.05ï¼Œåˆ™æ‹’ç»Hâ‚€ï¼Œè®¤ä¸ºå¹¶éæ‰€æœ‰æ€»ä½“éƒ½ç›¸åŒï¼›

## æŸå®¶åº—åˆ¶é€ å…¬å¸å‡†å¤‡è´­è¿›ä¸€æ‰¹ç”µæ± ï¼Œç°æœ‰Aï¼ŒBï¼ŒCä¸‰ä¸ªç”µæ± ç”Ÿäº§ä¼ä¸šæ„¿æ„ä¾›è´§ï¼Œä¸ºæ­¤æ ¡ä»–ä»¬ç”Ÿäº§çš„ç”µæ± è´¨é‡ï¼Œä»æ¯ä¸ªä¼ä¸šå„éšæœºæŠ½å–5èŠ‚ç”µæ± 
### 8.3.1åˆ†æ3ä¸ªä¼ä¸šç”Ÿäº§çš„ç”µæ± å¹³å‡å¯¿å‘½ä¹‹é—´æœ‰æ— æ˜¾è‘—å·®å¼‚(Î±=0.05)ï¼Œå¹¶åˆ†ææ•ˆåº”é‡ã€‚
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch8/exercise8_3.RData?raw=True")
exercise8_3
attach(exercise8_3)
model_3w<-aov(ç”µæ± å¯¿å‘½~ä¼ä¸š)
summary(model_3w)
```

 Hâ‚€:3ä¸ªä¼ä¸šç”Ÿäº§çš„ç”µæ± å¹³å‡å¯¿å‘½ä¹‹é—´æ— æ˜¾è‘—å·®å¼‚
 Hâ‚:3ä¸ªä¼ä¸šç”Ÿäº§çš„ç”µæ± å¹³å‡å¯¿å‘½ä¹‹é—´æœ‰æ˜¾è‘—å·®å¼‚
 ç”±åˆ†æç»“æœå¯çŸ¥ï¼Œp=0.00031<0.05ï¼Œæ‹’ç»Hâ‚€ï¼Œ3ä¸ªä¼ä¸šç”Ÿäº§çš„ç”µæ± å¹³å‡å¯¿å‘½ä¹‹é—´æœ‰æ˜¾è‘—å·®å¼‚ã€‚
```{r}
library(DescTools)
model_3w<-aov(ç”µæ± å¯¿å‘½~ä¼ä¸š)
EtaSq(model_3w,anova=T)
```
 ç”±æ•ˆåº”é‡ç»“æœ$\eta^2$=0.7399038å¯çŸ¥ï¼Œç»„é—´å·®å¼‚è¾ƒå¤§ã€‚ 

### å¦‚æœæœ‰å·®å¼‚ï¼Œç”¨HSDæ–¹æ³•æ£€éªŒå“ªäº›ä¼ä¸šä¹‹é—´æœ‰å·®å¼‚
```{r}
PostHocTest(model_3w,method="hsd")
```
 Hâ‚€:$n_i$=$n_j$
 Hâ‚:$n_i$â‰ $n_j$
 ç”±HSDåˆ†æç»“æœå¯çŸ¥ï¼š
 B-Açš„p-value=0.00046<0.05ï¼Œæ‹’ç»Hâ‚€ï¼Œè®¤ä¸ºBä¼ä¸šä¸Aä¼ä¸šä¹‹é—´æœ‰æ˜¾è‘—å·®å¼‚ï¼›
 C-Açš„p-value=0.78473>0.05ï¼Œä¸æ‹’ç»Hâ‚€ï¼Œä¸èƒ½è®¤ä¸ºCä¼ä¸šä¸Aä¼ä¸šä¹‹é—´æœ‰æ˜¾è‘—å·®å¼‚ï¼›
 C-Bçš„p-value=0.00140<0.05ï¼Œæ‹’ç»Hâ‚€ï¼Œè®¤ä¸ºCä¼ä¸šä¸Bä¼ä¸šä¹‹é—´æœ‰æ˜¾è‘—å·®å¼‚ï¼›


## æœ‰5ä¸ªä¸åŒå“ç§çš„ç§å­å’Œ4ä¸ªä¸åŒçš„æ–½è‚¥æ–¹æ¡ˆã€‚åœ¨20å—åŒæ ·é¢ç§¯çš„åœŸåœ°ä¸Šåˆ†åˆ«é‡‡ç”¨5ä¸ªä¸åŒå“ç§çš„ç§å­å’Œ4ä¸ªä¸åŒçš„æ–½è‚¥æ–¹æ¡ˆè¿›è¡Œè¯•éªŒ
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch8/exercise8_4.RData?raw=True")
exercise8_4
```

### æ£€éªŒä¸åŒå“ç§å’Œæ–½è‚¥é‡æ–¹æ¡ˆå¯¹äº§é‡çš„å½±å“æ˜¯å¦æ˜¾è‘—ï¼ˆÎ±=0.05ï¼‰
 Hâ‚€ï¼šä¸åŒå“ç§å’Œæ–½è‚¥é‡æ–¹æ¡ˆå¯¹äº§é‡çš„å½±å“ä¸æ˜¾è‘—
 Hâ‚ï¼šä¸åŒå“ç§å’Œæ–½è‚¥é‡æ–¹æ¡ˆå¯¹äº§é‡çš„å½±å“æ˜¾è‘—
```{r}
attach(exercise8_4)
model_2wm<-aov(æ”¶è·é‡~å“ç§+æ–½è‚¥æ–¹æ¡ˆ)
summary(model_2wm)
```
 åˆ†æï¼šå“ç§p-value=0.00332<0.05ï¼Œæ–½è‚¥æ–¹æ¡ˆp-value=0.00195 <0.05åˆ™æ‹’ç»Hâ‚€ï¼Œè®¤ä¸ºä¸åŒå“ç§å’Œæ–½è‚¥é‡æ–¹æ¡ˆå¯¹äº§é‡çš„å½±å“æ˜¾è‘—

### è®¡ç®—åæ•ˆåº”é‡å¹¶è¿›è¡Œåˆ†æ
```{r}
model_2wm<-aov(æ”¶è·é‡~å“ç§+æ–½è‚¥æ–¹æ¡ˆ)
library(DescTools)
EtaSq(model_2wm,anova=T)
```
 å“ç§$\eta^2$=0.4223081ï¼Œåˆ™è¡¨æ˜ç»„é—´å·®å¼‚è¾ƒå¤§
 æ–½è‚¥æ–¹æ¡ˆ$\eta^2$= 0.4026955ï¼Œåˆ™è¡¨æ˜ç»„é—´å·®å¼‚è¾ƒå¤§

## åŸå¸‚é“è·¯äº¤é€šç®¡ç†éƒ¨é—¨ä¸ºç ”ç©¶ä¸åŒè·¯æ®µå’Œä¸åŒæ—¶é—´æ®µå¯¹è¡Œè½¦æ—¶é—´çš„å½±å“ï¼Œè®©ä¸€åäº¤é€šè­¦å¯Ÿåˆ†åˆ«åœ¨3ä¸ªè·¯æ®µå’Œé«˜å³°æœŸä¸éé«˜å³°æœŸäº²è‡ªé©¾è½¦è¿›è¡Œå®éªŒï¼Œé€šè¿‡å®éªŒå¹¶è·å¾—30ä¸ªè¡Œè½¦æ—¶é—´æ•°æ®ã€‚
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch8/exercise8_5.RData?raw=True")
head(exercise8_5,15)
```

### åˆ†æè·¯æ®µæ—¶æ®µä»¥åŠè·¯æ®µå’Œæ—¶æ®µçš„äº¤äº’ä½œç”¨å¯¹è¡Œè½¦æ—¶é—´çš„å½±å“ï¼ˆÎ±=0.05ï¼‰
```{r}
attach(exercise8_5)
fit<- aov(è¡Œè½¦æ—¶é—´~æ—¶æ®µ + è·¯æ®µ + æ—¶æ®µ:è·¯æ®µ)
summary(fit)
```
 æ£€éªŒæ—¶æ®µçš„å‡è®¾ï¼š
 Hâ‚€:æ—¶æ®µå¯¹è¡Œè½¦æ—¶é—´æ— æ˜¾è‘—å½±å“
 Hâ‚:æ—¶æ®µå¯¹è¡Œè½¦æ—¶é—´æœ‰æ˜¾è‘—å½±å“

 æ£€éªŒè·¯æ®µçš„å‡è®¾ï¼š
 Hâ‚€:è·¯æ®µå¯¹è¡Œè½¦æ—¶é—´æ— æ˜¾è‘—å½±å“
 Hâ‚:è·¯æ®µå¯¹è¡Œè½¦æ—¶é—´æœ‰æ˜¾è‘—å½±å“

 æ£€éªŒæ—¶æ®µä¸è·¯æ®µäº¤äº’ä½œç”¨çš„å‡è®¾ï¼š
 Hâ‚€:æ—¶æ®µå’Œè·¯æ®µçš„äº¤äº’ä½œç”¨å¯¹è¡Œè½¦æ—¶é—´æ— æ˜¾è‘—å½±å“
 Hâ‚:æ—¶æ®µå’Œè·¯æ®µçš„äº¤äº’ä½œç”¨å¯¹è¡Œè½¦æ—¶é—´æœ‰æ˜¾è‘—å½±å“

 ç”±äº¤äº’æ•ˆåº”æ–¹å·®åˆ†æçš„ç»“æœå¯çŸ¥ï¼š

 æ—¶æ®µ$P_a$=1.36*10^(-8)<0.05,æ‹’ç»Hâ‚€ï¼Œè®¤ä¸ºæ—¶æ®µå¯¹è¡Œè½¦æ—¶é—´æœ‰æ˜¾è‘—å½±å“ã€‚


 è·¯æ®µ$P_b$=3.71*10^(-6)<0.05,æ‹’ç»Hâ‚€ï¼Œè®¤ä¸ºè·¯æ®µå¯¹è¡Œè½¦æ—¶é—´æœ‰æ˜¾è‘—å½±å“ã€‚


 æ—¶æ®µå’Œè·¯æ®µçš„äº¤äº’ä½œç”¨$P_ab$=0.997>0.05,ä¸æ‹’ç»Hâ‚€ï¼Œå³ä¸è®¤ä¸ºæ—¶æ®µå’Œè·¯æ®µçš„äº¤äº’ä½œç”¨å¯¹è¡Œè½¦æ—¶é—´æœ‰æ˜¾è‘—å½±å“ã€‚


### è®¡ç®—åæ•ˆåº”é‡å¹¶è¿›è¡Œåˆ†æã€‚

```{r}
model_5wi<-aov(è¡Œè½¦æ—¶é—´~æ—¶æ®µ + è·¯æ®µ + æ—¶æ®µ:è·¯æ®µ,data=exercise8_5)
library(DescTools)
EtaSq(model_5wi,anova=T)
```
 
 ç”±äº¤äº’ä½œç”¨æ•ˆåº”é‡åˆ†æç»“æœå¯çŸ¥ï¼š
 æ—¶æ®µçš„$\eta^2$(åæ•ˆåº”é‡)=0.7455777387ï¼Œå³ç»„é—´å·®å¼‚è¾ƒå¤§ã€‚
 è·¯æ®µçš„$\eta^2$=0.6472503358ï¼Œå³ç»„é—´å·®å¼‚è¾ƒå¤§ã€‚
 æ—¶æ®µå’Œè·¯æ®µçš„äº¤äº’ä½œç”¨çš„$\eta^2$=0.0002438925ï¼Œå³ç»„é—´å·®å¼‚è¾ƒå°ã€‚

## ä¸ºæ£€éªŒå¹¿å‘Šåª’ä½“å’Œå¹¿å‘Šæ–¹æ¡ˆå¯¹äº§å“é”€é‡çš„å½±å“ï¼Œä¸€å®¶è¥é”€å…¬å¸åšäº†ä¸€é¡¹å®éªŒï¼Œè€ƒå¯Ÿä¸‰ç§å¹¿å‘Šæ–¹æ¡ˆå’Œä¸¤ç§å¹¿å‘Šåª’ä½“ï¼Œè·å¾—çš„æ•°æ®å¦‚ä¸‹ï¼š
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch8/exercise8_6.RData?raw=True")
exercise8_6
```
### æ£€éªŒå¹¿å‘Šæ–¹æ¡ˆï¼Œå¹¿å‘Šåª’ä½“åŠå…¶ç›¸äº’ä½œç”¨å¯¹é”€å”®é‡çš„å½±å“æ˜¯å¦æ˜¾è‘—ï¼ˆÎ±=0.05ï¼‰

 Hâ‚€ï¼šå¹¿å‘Šæ–¹æ¡ˆå¯¹é”€å”®é‡çš„å½±å“ä¸æ˜¾è‘—
 Hâ‚ï¼šå¹¿å‘Šæ–¹æ¡ˆå¯¹é”€å”®é‡çš„å½±å“æ˜¾è‘—

 Hâ‚€ï¼šå¹¿å‘Šåª’ä½“å¯¹é”€å”®é‡çš„å½±å“ä¸æ˜¾è‘—
 Hâ‚ï¼šå¹¿å‘Šåª’ä½“å¯¹é”€å”®é‡çš„å½±å“æ˜¾è‘—

 Hâ‚€ï¼šäº¤äº’æ•ˆåº”å¯¹é”€å”®é‡çš„å½±å“ä¸æ˜¾è‘—
 Hâ‚ï¼šäº¤äº’æ•ˆåº”å¯¹é”€å”®é‡çš„å½±å“æ˜¾è‘—
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch8/exercise8_6.RData?raw=True")
mode2<-aov(é”€å”®é‡~å¹¿å‘Šæ–¹æ¡ˆ+å¹¿å‘Šåª’ä½“+å¹¿å‘Šæ–¹æ¡ˆ:å¹¿å‘Šåª’ä½“,data=exercise8_6)
summary(mode2)
mode2$coefficients
```
 åˆ†æ:å…³äºå¹¿å‘Šæ–¹æ¡ˆçš„p-value=0.0104<0.05ï¼Œåˆ™æ‹’ç»Hâ‚€ï¼Œè®¤ä¸ºå¹¿å‘Šæ–¹æ¡ˆå¯¹é”€å”®é‡çš„å½±å“æ˜¾è‘—ï¼›
 å…³äºå¹¿å‘Šåª’ä½“çš„p-value=0.1340>0.05ï¼Œåˆ™ä¸èƒ½æ‹’ç»Hâ‚€ï¼Œå³ä¸èƒ½è®¤ä¸ºå¹¿å‘Šåª’ä½“å¯¹é”€å”®é‡çš„å½±å“æ˜¾è‘—ï¼›
 äº¤äº’æ•ˆåº” p-value=0.251>0.05ï¼Œåˆ™ä¸èƒ½æ‹’ç»Hâ‚€ï¼Œå³ä¸èƒ½è®¤ä¸ºäº¤äº’æ•ˆåº”å¯¹é”€å”®é‡çš„å½±å“ä¸æ˜¾è‘—


### è®¡ç®—åæ•ˆåº”é‡å¹¶è¿›è¡Œåˆ†æ
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch8/exercise8_6.RData?raw=True")
model_2wi<-aov (é”€å”®é‡~å¹¿å‘Šæ–¹æ¡ˆ+å¹¿å‘Šåª’ä½“+å¹¿å‘Šæ–¹æ¡ˆ:å¹¿å‘Šåª’ä½“,data=exercise8_6)
library(DescTools) 
EtaSq(model_2wi,anova=T) 
```
 åˆ†æ:ç»“æœè¡¨æ˜ï¼Œåœ¨æ’é™¤å¹¿å‘Šåª’ä½“å’Œäº¤äº’æ•ˆåº”çš„å½±å“åï¼Œå¹¿å‘Šæ–¹æ¡ˆè§£é‡Šäº†é”€å”®é‡è¯¯å·®çš„63.24%;
 åœ¨æ’é™¤å¹¿å‘Šæ–¹æ¡ˆå’Œäº¤äº’æ•ˆåº”çš„å½±å“åï¼Œå¹¿å‘Šåª’ä½“è§£é‡Šäº†é”€å”®é‡è¯¯å·®çš„8.82%;
 åœ¨æ’é™¤å¹¿å‘Šåª’ä½“å’Œå¹¿å‘Šæ–¹æ¡ˆçš„å½±å“åï¼Œäº¤äº’æ•ˆåº”è§£é‡Šäº†é”€å”®é‡è¯¯å·®çš„10.29%ã€‚

# ç¬¬ä¹ç«  ä¸€å…ƒçº¿æ€§å›å½’
## ä¸‹é¢æ˜¯æˆ‘å›½31åœ°åŒº2013å¹´çš„å±…æ°‘æ¶ˆè´¹æ°´å¹³å’Œäººå‡GDPæ•°æ®ã€‚
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch9/exercise9_1.RData?raw=True")
head(exercise9_1,10)
```

### ç»˜åˆ¶æ•£ç‚¹å›¾ï¼Œåˆ¤æ–­äººå‡GDPä¸å±…æ°‘æ¶ˆè´¹æ°´å¹³ä¹‹é—´çš„å…³ç³»ï¼Œå¹¶è®¡ç®—ç›¸å…³ç³»æ•°åˆ†æå…¶å…³ç³»å¼ºåº¦ã€‚
```{r, fig.height = 3, fig.width = 4}
library(car)
scatterplot(å±…æ°‘æ¶ˆè´¹æ°´å¹³~äººå‡GDP,data=exercise9_1,col="black",pch=19,xlab="äººå‡GDP",ylab="å±…æ°‘æ¶ˆè´¹æ°´å¹³",cex.lab=0.8)
cor(exercise9_1[,2],exercise9_1[,3])
```

  ç»“è®º;æ•£ç‚¹å›¾æ˜¾ç¤ºï¼Œäººå‡GDPå¢åŠ ï¼Œå±…æ°‘æ¶ˆè´¹æ°´å¹³ä¹Ÿéšä¹‹å¢åŠ ã€‚äºŒè€…çš„è§‚æµ‹ç‚¹åˆ†å¸ƒåœ¨ä¸€æ¡ç›´çº¿å‘¨å›´ï¼Œå› è€Œå…·æœ‰æ­£çš„çº¿æ€§ç›¸å…³å…³ç³»ã€‚äººå‡GDPä¸å±…æ°‘æ¶ˆè´¹æ°´å¹³ä¹‹é—´çš„ç›¸å…³ç³»æ•°ä¸º0.9240374ï¼Œæ‰€ä»¥ä¸¤è€…ä¹‹é—´å…·æœ‰è¾ƒå¼ºçš„ç›¸å…³æ€§ã€‚

### ä»¥å±…æ°‘æ¶ˆè´¹æ°´å¹³ä¸ºå› å˜é‡ã€äººå‡GDPä¸ºè‡ªå˜é‡å»ºç«‹å›å½’æ¨¡å‹ï¼Œå¹¶å¯¹å›å½’æ¨¡å‹è¿›è¡Œç»¼åˆè¯„ä»·ã€‚
```{r}
model<-lm(å±…æ°‘æ¶ˆè´¹æ°´å¹³~äººå‡GDP,data=exercise9_1)
summary(model)
confint(model,level=0.95)
anova(model)
```

  ç»¼åˆè¯„ä»·;å›å½’ç³»æ•°ä¸º0.3194ï¼Œå¯¹å›å½’ç³»æ•°è¿›è¡Œæ˜¾è‘—æ€§æ£€éªŒï¼Œå…¶På€¼=1.227x10^(-13)< 0.05,æ‰€ä»¥ä¸¤è€…ä¹‹é—´çš„çº¿æ€§å…³ç³»æ˜¾è‘—ã€‚å¯¹æ¨¡å‹è¿›è¡Œæ‹Ÿåˆåº¦æ£€éªŒï¼ŒPå€¼=0.227x10^ (-13)<0.05ï¼Œè¯æ˜æ¨¡å‹æ‹Ÿåˆæ•ˆæœå¾ˆå¥½ã€‚
  
## ä»æŸä¸€è¡Œä¸šä¸­éšæœºæŠ½å–12å®¶ä¼ä¸šï¼Œå¾—åˆ°äº§é‡ä¸ç”Ÿäº§è´¹ç”¨æ•°æ®å¦‚ä¸‹ï¼š
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch9/exercise9_2.RData?raw=True")
exercise9_2
```

### ç»˜åˆ¶äº§é‡ä¸ç”Ÿäº§è´¹ç”¨çš„æ•£ç‚¹å›¾ï¼Œåˆ¤æ–­äºŒè€…ä¹‹é—´çš„å…³ç³»å½¢æ€ã€‚
```{r, fig.height = 3, fig.width = 4}
library(car)
attach(exercise9_2)
scatterplot(äº§é‡~ç”Ÿäº§è´¹ç”¨,data=exercise9_1,col="black",pch=19,xlab="ç”Ÿäº§è´¹ç”¨",ylab="äº§é‡",cex.lab=0.8)
```


  ç»“è®ºï¼šæ•£ç‚¹å›¾æ˜¾ç¤ºï¼Œéšç€ç”Ÿäº§è´¹ç”¨å¢åŠ ï¼Œäº§é‡ä¹Ÿéšä¹‹å¢åŠ ã€‚äºŒè€…çš„è§‚æµ‹ç‚¹åˆ†å¸ƒåœ¨ä¸€æ¡ç›´çº¿å‘¨å›´ï¼Œå› è€Œå…·æœ‰æ­£çš„çº¿æ€§ç›¸å…³å…³ç³»ã€‚


### è®¡ç®—äº§é‡ä¸ç”Ÿäº§è´¹ç”¨ä¹‹é—´çš„çº¿æ€§ç›¸å…³ç³»æ•°ï¼Œå¯¹ç›¸å…³ç³»æ•°çš„æ˜¾è‘—æ€§è¿›è¡Œæ£€éªŒï¼Œå¹¶è§£é‡ŠäºŒè€…ä¹‹é—´çš„å…³ç³»å¼ºåº¦
```{r}
cor(exercise9_2[,2],exercise9_2[,3]) 
cor.test(exercise9_2[,2],exercise9_2[,3])
```
  
  ç»“è®ºï¼šäº§é‡å’Œç”Ÿäº§è´¹ç”¨ä¹‹é—´çš„ç›¸å…³ç³»æ•°ä¸º0.9202324ï¼Œè¡¨æ˜ä¸¤è€…ä¹‹é—´å…·æœ‰å¾ˆå¼ºçš„ç›¸å…³æ€§å¯¹ç›¸å…³ç³»æ•°è¿›è¡Œæ£€éªŒï¼ŒPå€¼=2.222(*)10^(-5)<0.05ï¼Œæ‹’ç»åŸå‡è®¾ï¼Œå³è®¤ä¸ºä¸¤å˜é‡ä¹‹é—´çº¿æ€§å…³ç³»æ˜¾è‘—ã€‚

## éšæœºæŠ½å–10å®¶èˆªç©ºå…¬å¸ï¼Œå¯¹å…¶æœ€è¿‘ä¸€å¹´çš„èˆªç­å‡†ç‚¹ç‡å’Œé¡¾å®¢æŠ•è¯‰æ¬¡æ•°è¿›è¡Œè°ƒæŸ¥ï¼Œæ‰€å¾—æ•°æ®å¦‚ä¸‹ï¼š
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch9/exercise9_3.RData?raw=True")
exercise9_3
```
### ç”¨èˆªç­å‡†ç‚¹ç‡ä½œè‡ªå˜é‡ï¼Œé¡¾å®¢æŠ•è¯‰æ¬¡æ•°ä½œå› å˜é‡ï¼Œæ±‚å‡ºä¼°è®¡çš„å›å½’æ–¹ç¨‹ï¼Œå¹¶è§£é‡Šå›å½’ç³»æ•°çš„æ„ä¹‰ã€‚
```{r}
model3<-lm(æŠ•è¯‰æ¬¡æ•°~èˆªç­å‡†ç‚¹ç‡,data=exercise9_3)
model3
```

  ç»“è®ºï¼šä¼°è®¡çš„å›å½’æ–¹ç¨‹ä¸º$\hat{y}$=-4.701x+430.189ã€‚å›å½’ç³»æ•°ä¸º-4.701ï¼Œè¡¨ç¤ºèˆªç­å‡†ç‚¹ç‡æ¯æé«˜ä¸€ä¸ªç™¾åˆ†ç‚¹ï¼ŒæŠ•è¯‰æ¬¡æ•°ä¾¿ä¸‹é™4.7006æ¬¡ã€‚

### æ£€éªŒå›å½’ç³»æ•°çš„æ˜¾è‘—æ€§
```{r}
summary(model3)
```

  ç»“è®ºï¼šæ£€éªŒç»“æœå¯çŸ¥F=24.59ï¼ŒPå€¼=0.001108<0.05ï¼Œæ‰€ä»¥æ‹’ç»åŸå‡è®¾ï¼Œè®¤ä¸ºä¸¤ä¸ªå˜é‡ä¹‹é—´çº¿æ€§å…³ç³»æ˜¾è‘—ã€‚

## å¦‚æœèˆªç­å‡†ç‚¹ç‡ä¸º80%ï¼Œä¼°è®¡é¡¾å®¢çš„æŠ•è¯‰æ¬¡æ•°ã€‚
```{r}
p1=(-4.701)*80+430.189
p1
```

  ç»“è®ºï¼šå¦‚æœèˆªç­å‡†ç‚¹ç‡ä¸º80%ï¼Œä¼°è®¡é¡¾å®¢çš„æŠ•è¯‰æ¬¡æ•°ä¸º54.109æ¬¡ã€‚

## éšæœºæŠ½å–7å®¶è¶…å¸‚ï¼Œå¾—åˆ°å…¶å¹¿å‘Šè´¹æ”¯å‡ºå’Œé”€å”®é¢æ•°æ®å¦‚ä¸‹ï¼š
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch9/exercise9_4.RData?raw=True")
exercise9_4
```

  ç»“è®ºï¼šç”¨å¹¿å‘Šè´¹æ”¯å‡ºä½œè‡ªå˜é‡xï¼Œé”€å”®é¢åšå› å˜é‡yå»ºç«‹å›å½’æ¨¡å‹ï¼Œå¹¶å¯¹æ¨¡å‹è¿›è¡Œè¯Šæ–­å’Œè¯„ä»·ã€‚

### åœ¨ä¸€å…ƒçº¿æ€§å›å½’æ¨¡å‹ä¸­ï¼Œé¦–å…ˆå‡å®šyä¸xä¹‹é—´æ˜¯çº¿æ€§å…³ç³»ï¼ŒåŒæ—¶å‡å®šetaæ˜¯æœŸæœ›å€¼ä¸º0ã€æ–¹å·®ç›¸ç­‰ä¸”æœä»æ­£æ€åˆ†å¸ƒçš„ç‹¬ç«‹éšæœºå˜é‡ã€‚æ¨¡å‹è¯Šæ–­å°±è¦é’ˆå¯¹ä»¥ä¸Šé—®é¢˜è¿›è¡Œè¯Šæ–­ã€‚
```{r, fig.height = 3, fig.width = 4}
model4<-lm(é”€å”®é¢~å¹¿å‘Šè´¹æ”¯å‡º,data=exercise9_4)
par(mfrow=c(2,2),mar=c(2.0,2.0,1.8,1.5),cex=0.8,cex.main=0.6)
plot(model4)
library(car)
durbinWatsonTest(model4)
```

  ç»“è®º:ç”±NormalQ-Qå›¾å¯çŸ¥ï¼Œè¯¥æ¨¡å‹æ®‹å·®åŸºæœ¬ç¬¦åˆæ­£æ€æ€§å‡å®šã€‚ç”±ResidualsvsFittedå›¾å¯çŸ¥ï¼Œå¹¿å‘Šè´¹æ”¯å‡ºå’Œé”€å”®é¢ä¹‹é—´ä¸ºçº¿æ€§å…³ç³»çš„å‡å®šæˆç«‹ã€‚ç”±Scale-Locationå›¾å¯çŸ¥ï¼Œè¯¥æ¨¡å‹å…³äºetaæ–¹å·®é½æ€§çš„å‡å®šåŸºæœ¬æˆç«‹ã€‚æ®‹å·®ç‹¬ç«‹æ€§æ£€éªŒä¸­ï¼ŒPå€¼=0.086>0.05ï¼Œæ‰€ä»¥ä¸æ‹’ç»åŸå‡è®¾ï¼Œæ˜¾ç¤ºæ®‹å·®æ— è‡ªç›¸å…³ã€‚

# ç¬¬åç«  å¤šå…ƒçº¿æ€§å›å½’

## ä¸€å®¶ç”µå™¨é”€å”®å…¬å¸çš„ç®¡ç†äººå‘˜è®¤ä¸ºï¼Œæ¯æœˆçš„é”€å”®æ”¶å…¥æ˜¯å¹¿å‘Šè´¹ç”¨çš„å‡½æ•°ï¼Œå¹¶æƒ³é€šè¿‡å¹¿å‘Šè´¹ç”¨å¯¹æœˆé”€å”®æ”¶å…¥è¿›è¡Œä¼°è®¡ï¼Œä¸‹é¢æ˜¯è¿‘8ä¸ªæœˆçš„é”€å”®æ”¶å…¥ä¸å¹¿å‘Šè´¹ç”¨æ•°æ®ï¼š

### ç”¨ç”µè§†å¹¿å‘Šè´¹ç”¨å’ŒæŠ¥çº¸å¹¿å‘Šè´¹ç”¨ä½œè‡ªå˜é‡ï¼Œå»ºç«‹ä¼°è®¡çš„å›å½’æ–¹ç¨‹ï¼Œå¹¶è¯´æ˜å›å½’ç³»æ•°çš„æ„ä¹‰ã€‚
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch10/exercise10_1.RData?raw=True")
exercise10_1
model1<-lm(æœˆé”€å”®æ”¶å…¥~ç”µè§†å¹¿å‘Šè´¹ç”¨+æŠ¥çº¸å¹¿å‘Šè´¹ç”¨,data=exercise10_1)
summary(model1)
```

 ä»¤yè¡¨ç¤ºæœˆé”€å”®æ”¶å…¥ï¼Œ$x_1$è¡¨ç¤ºç”µè§†å¹¿å‘Šè´¹ç”¨ï¼Œ$x_2$è¡¨ç¤ºæŠ¥çº¸å¹¿å‘Šè´¹ç”¨
 ç”±å¤šå…ƒçº¿æ€§å›å½’å»ºæ¨¡ç»“æœå¯çŸ¥å›å½’æ–¹ç¨‹ä¸ºï¼š$\hat{y}$=832.3009+2.2902$x_1$+1.3010$x_2$
 å„å›å½’ç³»æ•°çš„å®é™…æ„ä¹‰ä¸ºï¼š
 $\beta_1$=2.2902è¡¨ç¤ºï¼Œåœ¨æŠ¥çº¸å¹¿å‘Šè´¹ç”¨ä¸å˜çš„æ¡ä»¶ä¸‹ï¼Œç”µè§†å¹¿å‘Šè´¹ç”¨æ¯å˜åŠ¨1ä¸‡å…ƒï¼Œæœˆé”€å”®æ”¶å…¥å¹³å‡å˜åŠ¨2.2902ä¸‡å…ƒï¼›
 $\beta_2$=1.3010è¡¨ç¤ºï¼Œåœ¨ç”µè§†å¹¿å‘Šè´¹ç”¨ä¸å˜çš„æ¡ä»¶ä¸‹ï¼ŒæŠ¥çº¸å¹¿å‘Šè´¹ç”¨æ¯å˜åŠ¨1ä¸‡å…ƒï¼Œæœˆé”€å”®æ”¶å…¥å¹³å‡å˜åŠ¨1.3010ä¸‡å…ƒã€‚

### å¯¹å›å½’æ¨¡å‹åšç»¼åˆè¯„ä¼°ã€‚

```{r}
confint(model1,level=0.95)
anova(model1)
```

 Hâ‚€:$\beta_i$=0(è‡ªå˜é‡$x_i$ä¸å› å˜é‡yæ²¡æœ‰çº¿æ€§å…³ç³»)
 Hâ‚:$\beta_i$â‰ 0(è‡ªå˜é‡$x_i$ä¸å› å˜é‡yæœ‰çº¿æ€§å…³ç³»)
 ç»¼åˆè¯„ä¼°ï¼šå¯¹å›å½’ç³»æ•°è¿›è¡Œæ˜¾è‘—æ€§æ£€éªŒï¼Œå…¶På€¼=0.001865<0.05ï¼Œæ‰€ä»¥æœˆé”€å”®æ”¶å…¥ä¸ç”µè§†å¹¿å‘Šè´¹ç”¨å’Œè¡¨ç¤ºæŠ¥çº¸å¹¿å‘Šè´¹ç”¨ä¹‹é—´çº¿æ€§å…³ç³»æ˜¾è‘—ï¼›å¯¹æ¨¡å‹è¿›è¡Œæ‹Ÿåˆåº¦æ£€éªŒï¼Œç”µè§†å¹¿å‘Šè´¹ç”¨På€¼=0.001432<0.05ï¼ŒæŠ¥çº¸å¹¿å‘Šè´¹ç”¨På€¼=0.009761<0.05ï¼Œè¯æ˜æ¨¡å‹æ‹Ÿåˆæ•ˆæœå¾ˆå¥½ã€‚


### ç»™å®šç”µè§†å¹¿å‘Šè´¹ç”¨ä¸º30ä¸‡å…ƒï¼ŒæŠ¥çº¸å¹¿å‘Šè´¹ç”¨ä¸º20ä¸‡å…ƒï¼Œæ±‚æœˆé”€å”®æ”¶å…¥95%çš„ç½®ä¿¡åŒºé—´å’Œé¢„æµ‹åŒºé—´ã€‚
```{r}
model1<-lm(æœˆé”€å”®æ”¶å…¥~ç”µè§†å¹¿å‘Šè´¹ç”¨+æŠ¥çº¸å¹¿å‘Šè´¹ç”¨,data=exercise10_1)
x0<-data.frame(ç”µè§†å¹¿å‘Šè´¹ç”¨=30,æŠ¥çº¸å¹¿å‘Šè´¹ç”¨=20)
predict(model1,data.frame(ç”µè§†å¹¿å‘Šè´¹ç”¨=30,æŠ¥çº¸å¹¿å‘Šè´¹ç”¨=20),interval="confidence",level=0.95)
predict(model1,data.frame(ç”µè§†å¹¿å‘Šè´¹ç”¨=30,æŠ¥çº¸å¹¿å‘Šè´¹ç”¨=20),interval="prediction",level=0.95)
```

  åˆ†æï¼šç”±é€æ­¥å›å½’é¢„æµ‹ç»“æœå¯çŸ¥ï¼šåœ¨ç”µè§†å¹¿å‘Šè´¹ç”¨ä¸º30ä¸‡å…ƒå’ŒæŠ¥çº¸å¹¿å‘Šè´¹ç”¨ä¸º20ä¸‡å…ƒæ—¶ï¼Œæœˆé”€å”®æ”¶å…¥95%çš„ç½®ä¿¡åŒºé—´ä¸º[919.4121,934.6403]å’Œé¢„æµ‹åŒºé—´[908.8376,945.2148]ã€‚

## æŸå†œåœºé€šè¿‡è¯•éªŒå–å¾—æ—©ç¨»æ”¶è·é‡å’Œæ˜¥å­£é™é›¨é‡å’Œæ˜¥å­£æ¸©åº¦çš„æ•°æ®å¦‚ä¸‹
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch10/exercise10_2.RData?raw=True")
exercise10_2
```

### å»ºç«‹æ—©ç¨»æ”¶è·é‡å¯¹æ˜¥å­£é™é›¨é‡å’Œæ˜¥å­£æ¸©åº¦çš„äºŒå…ƒçº¿æ€§å›å½’æ–¹ç¨‹ï¼Œå¹¶å¯¹å›å½’æ¨¡å‹çš„çº¿æ€§å…³ç³»å’Œå›å½’ç³»æ•°è¿›è¡Œæ£€éªŒï¼ˆÎ±=0.05ï¼‰ï¼Œä½ è®¤ä¸ºæ¨¡å‹ä¸­æ˜¯å¦å­˜åœ¨å¤šé‡å…±çº¿æ€§

### å»ºç«‹å›å½’æ–¹ç¨‹
```{r}
model2<-lm(æ”¶è·é‡~é™é›¨é‡+æ¸©åº¦,data=exercise10_2)
summary(model2)
```

 ä»¤y=æ”¶è·é‡ï¼Œx~1~=é™é›¨é‡ï¼Œx~2~=æ¸©åº¦ï¼Œåˆ™å›å½’æ–¹ç¨‹ä¸º$\hat{y}$=-0.591+22.387$x_1$+327.672$x_2$
 å›å½’ç³»æ•°æ˜¾è‘—æ€§æ£€éªŒï¼š
 Hâ‚€ï¼šçº¿æ€§å…³ç³»ä¸æ˜¾è‘—
 Hâ‚ï¼šÎ²~1~,Î²~2~è‡³å°‘æœ‰ä¸€ä¸ªä¸ç­‰äº0
 é™é›¨é‡p-value=0.0801>0.05ï¼Œæ¸©åº¦p-value=0.0295<0.05ï¼Œåˆ™é™æ°´é‡çš„å½±å“æ˜¯ä¸æ˜¾è‘—çš„ï¼Œæ¸©åº¦çš„å½±å“æ˜¯æ˜¾è‘—çš„
 å¤šé‡å…±çº¿æ€§ï¼š
 Hâ‚€ï¼šè‡ªå˜é‡x~i~ä¸å› å˜é‡yæ²¡æœ‰çº¿æ€§å…³ç³»
 Hâ‚ï¼šè‡ªå˜é‡x~i~ä¸å› å˜é‡yæœ‰çº¿æ€§å…³ç³»
```{r}
library(psych)
corr.test(exercise10_2,use="complete")
```
        æ”¶è·é‡ é™é›¨é‡ æ¸©åº¦
æ”¶è·é‡   1.00   0.98 0.99
é™é›¨é‡   0.98   1.00 0.97
æ¸©åº¦     0.99   0.97 1.00


### æ¯”è¾ƒé™é›¨é‡å’Œæ¸©åº¦åœ¨é¢„æµ‹æ”¶è·é‡ä¸­çš„ç›¸å¯¹é‡è¦æ€§
```{r}
attach(exercise10_2)
model2<-lm(æ”¶è·é‡~é™é›¨é‡+æ¸©åº¦,data=exercise10_2)
library(lm.beta)
model1.beta<-lm.beta(model1)
summary(model1.beta)
```

 åˆ†æï¼šç»“æœæ˜¾ç¤ºå„æ ‡å‡†åŒ–å›å½’ç³»æ•°ä¸ºï¼š0.4146ï¼Œ0.5896ï¼ŒÎ²~2~çš„ç›¸å¯¹é‡è¦æ€§å¤§äºÎ²~1~,å³é™é›¨é‡å¯¹æ”¶è·é‡çš„é¢„æµ‹æ›´é‡è¦ã€‚


## ä¸ºåˆ†æå½±å“ä¸è‰¯è´·æ¬¾çš„å› ç´ ï¼Œä¸€å®¶å•†ä¸šé“¶è¡Œåœ¨æ‰€å±çš„å¤šå®¶åˆ†è¡Œä¸­éšæœºæŠ½å–25å®¶ï¼Œå¾—åˆ°ä¸è‰¯è´·æ¬¾ã€è´·æ¬¾ä½™é¢ã€åº”æ”¶è´·æ¬¾ã€è´·æ¬¾é¡¹ç›®ä¸ªæ•°ã€å›ºå®šèµ„äº§æŠ•èµ„ç­‰æœ‰å…³æ•°æ®å¦‚ä¸‹ï¼š
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch10/exercise10_3.RData?raw=True")
head(exercise10_3,10)
```

### ç”¨ä¸è‰¯è´·æ¬¾ä½œå› å˜é‡ï¼Œå»ºç«‹å¤šå…ƒçº¿æ€§å›å½’æ¨¡å‹ã€‚
```{r}
attach(exercise10_3)
model3=lm(ä¸è‰¯è´·æ¬¾~è´·æ¬¾ä½™é¢+åº”æ”¶è´·æ¬¾+è´·æ¬¾é¡¹ç›®ä¸ªæ•°+å›ºå®šèµ„äº§æŠ•èµ„,data=exercise10_3)
summary(model3)
```

 åˆ†æï¼šè´·æ¬¾ä½™é¢ç”¨å»ºç«‹çš„å¤šå…ƒçº¿æ€§å›å½’æ–¹ç¨‹ä¸º$\hat{y}=0.04X_1+0.15X_2+0.014X_3-0.03X_4-1.02$


### åˆ†ææ¨¡å‹ä¸­æ˜¯å¦å­˜åœ¨å…±çº¿æ€§ã€‚
### é‡‡ç”¨å¯¹æ¨¡å‹ä¸­å„è‡ªå˜é‡ä¹‹é—´çš„ç›¸å…³ç³»æ•°è¿›è¡Œæ£€éªŒçš„æ–¹æ³•è¯†åˆ«å¤šé‡å…±çº¿æ€§
```{r}
library(psych)
corr.test(exercise10_3[2:5],use="complete")
```


### ç”¨é€æ­¥å›å½’æ–¹æ³•å»ºç«‹å›å½’æ¨¡å‹
```{r}
model3.1=step(model3)
```

  åˆ†æ:ä»é€æ­¥å›å½’ç»“æœä¸­ï¼Œé€‰æ‹©å…¨éƒ¨è‡ªå˜é‡æ—¶AIC=33.22ï¼Œå»æ‰å˜é‡â€œè´·æ¬¾é¡¹ç›®ä¸ªæ•°â€ä¹‹åACI=31.26ï¼Œä¹‹åå»æ‰ä»»ä½•ä¸€ä¸ªè§£é‡Šå˜é‡ACIéƒ½ä¼šå˜å¤§ï¼Œæ•…æœ€ç»ˆæ¨¡å‹ä¸­ä¿ç•™â€œåº”æ”¶è´¦æ¬¾â€ã€â€œå›ºå®šèµ„äº§æŠ•èµ„â€ã€â€œè´·æ¬¾ä½™é¢â€ä¸‰ä¸ªè§£é‡Šå˜é‡ã€‚


### æ¯”è¾ƒ4ä¸ªè‡ªå˜é‡åœ¨ä¸è‰¯è´·æ¬¾ä¸­çš„ç›¸å¯¹é‡è¦æ€§
```{r}
library(lm.beta)
model3.beta=lm.beta(model3)
summary(model3.beta)
```

 åˆ†æï¼šå„æ ‡å‡†åŒ–çš„å›å½’ç³»æ•°ä¸ºï¼š$\hat{\beta_1}=0.89131ï¼Œ\hat{\beta_2}=0.25982 ï¼Œ\hat{\beta_3}= 0.03447 ï¼Œ\hat{\beta_4}$= -0.32492 -0.32492$,æ‰€ä»¥è´·æ¬¾ä½™é¢æ˜¯é¢„æµ‹ä¸è‰¯è´·æ¬¾æœ€é‡è¦çš„å˜é‡ã€‚

### ç”¨anovaå’ŒAICä¸¤ç§æ–¹æ³•å¯¹æ¨¡å‹è¿›è¡Œæ¯”è¾ƒå’Œåˆ†æ
```{r}
model3_1=lm(ä¸è‰¯è´·æ¬¾~è´·æ¬¾ä½™é¢+åº”æ”¶è´·æ¬¾+è´·æ¬¾é¡¹ç›®ä¸ªæ•°+å›ºå®šèµ„äº§æŠ•èµ„,data=exercise10_3)
model3_2=lm(ä¸è‰¯è´·æ¬¾~è´·æ¬¾ä½™é¢+åº”æ”¶è´·æ¬¾+å›ºå®šèµ„äº§æŠ•èµ„,data=exercise10_3)
anova(model3_2,model3_1)
AIC(model3_2,model3_1)
```

 åˆ†æ:p-value=0.8629>0.05,è¡¨æ˜ä¸¤ä¸ªå˜é‡ä¹‹é—´æ— æ˜¾è‘—å·®å¼‚ã€‚

## ä¸ºåˆ†ææŸè¡Œä¸šä¸­è–ªæ°´æœ‰æ— æ€§åˆ«æ­§è§†ã€‚ä»è¯¥è¡Œä¸šä¸­é€ŸæœºæŠ½å–15åå‘˜å·¥
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch10/exercise10_4.RData?raw=True")
exercise10_4
```

### å»ºç«‹æœˆè–ªä¸å·¥é¾„çš„ä¸€å…ƒå›å½’æ¨¡å‹
```{r}
model<-lm(æœˆè–ª~å·¥é¾„,data=exercise10_4)
summary(model)
```

 åˆ†æï¼šä»¤y=æœˆè–ªï¼Œx=å·¥é¾„ï¼Œåˆ™å›å½’æ–¹ç¨‹ä¸ºï¼š$\hat{y}$=327.2x+5249.7


### å»ºç«‹æœˆè–ªä¸å·¥é¾„å’Œæ€§åˆ«çš„äºŒå…ƒå›å½’æ¨¡å‹
```{r}
model4<-lm(æœˆè–ª~å·¥é¾„+æ€§åˆ«,data=exercise10_4)
summary(model4)
```

 ä»¤ y=æœˆè–ªï¼Œ$x_1$=å·¥é¾„ï¼Œ$x_2$=æ€§åˆ«å¥³ï¼Œåˆ™å›å½’æ–¹ç¨‹ä¸ºï¼š$\hat{y}=111.22x_1+-458.68x_2+6190.74$


### å¯¹ä¸¤ä¸ªæ¨¡å‹è¿›è¡Œæ¯”è¾ƒï¼Œçœ‹çœ‹å¼•å…¥æ€§åˆ«è¿™ä¸€å˜é‡å¯¹é¢„æµ‹æœˆè–ªæ˜¯å¦æœ‰ç”¨
##### Hâ‚€ï¼šÎ²~2~=0
##### Hâ‚ï¼šÎ²~2~â‰ 0
```{r}
model1<-lm(æœˆè–ª~å·¥é¾„+æ€§åˆ«,data=exercise10_4) 
model2<-lm(æœˆè–ª~å·¥é¾„,data=exercise10_4)
anova(model2,model1)
```

 åˆ†æï¼šp-value=1.823e-06<0.05,åˆ™æ‹’ç»åŸå‡è®¾ï¼Œè®¤ä¸ºå¼•å…¥æ€§åˆ«è¿™ä¸€å˜é‡å¯¹é¢„æµ‹æœˆè–ªæ˜¯æœ‰ç”¨ã€‚



# ç¬¬åä¸€ç«  æ—¶é—´åºåˆ—é¢„æµ‹
### æ ¹æ®2006-2015å¹´ä¸­å›½å·¥ä¸šç”Ÿäº§è€…å‡ºå‚ä»·æ ¼æŒ‡æ•°(PPI)æ•°æ®(ä¸Šå¹´=100)ï¼Œé‡‡ç”¨æŒ‡æ•°å¹³æ»‘æ³•é¢„æµ‹2016å¹´çš„PPIï¼Œå¹¶å¯¹å®é™…å€¼å’Œé¢„æµ‹å€¼ç»˜å›¾è¿›è¡Œæ¯”è¾ƒã€‚
```{r, fig.height = 3, fig.width = 4}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch11/exercise11_1.RData?raw=True")
exercise11_1<-ts(exercise11_1,start=2006)
par(mai=c(0.6,0.6,0.12,0.1) ,cex=0.7)
plot(exercise11_1[,2],type='o',xlab="ï¼ˆaï¼‰å¹´ä»½",ylab="PPI")
cpiforecast<-HoltWinters(exercise11_1[,2],beta=FALSE,gamma=FALSE)
library(forecast)
cpiforecast<-forecast(cpiforecast,h=1)
cpiforecast
plot(cpiforecast,type='o',xlab="å¹´ä»½",ylab="PPI",main="")
```

 åˆ†æï¼šå›¾ä¸­æŠ˜çº¿æ˜¯PPIçš„è§‚æµ‹å€¼ï¼Œåœ†ç‚¹æ˜¯2016å¹´çš„é¢„æµ‹å€¼ï¼Œç°è‰²åŒºåŸŸæ˜¯é¢„æµ‹å€¼çš„ç½®ä¿¡åŒºé—´ï¼Œå…¶ä¸­æµ…ç°è‰²åŒºåŸŸæ˜¯95%çš„ç½®ä¿¡åŒºé—´ï¼Œæ·±ç°è‰²åŒºåŸŸæ˜¯80%çš„ç½®ä¿¡åŒºé—´ã€‚


## æ ¹æ®1990-2010å¹´æˆ‘å›½åŸæ²¹äº§é‡æ•°æ®ï¼Œåˆ†åˆ«é‡‡ç”¨ä¸€å…ƒçº¿æ€§å›å½’æ¨¡å‹å’ŒHoltæŒ‡æ•°å¹³æ»‘æ¨¡å‹é¢„æµ‹2011å¹´çš„åŸæ²¹äº§é‡ï¼Œå¹¶ç»˜åˆ¶æ®‹å·®å›¾å¯¹ä¸¤ç§æ–¹æ³•çš„é¢„æµ‹æ•ˆæœè¿›è¡Œæ¯”è¾ƒã€‚
### ä¸€å…ƒçº¿æ€§å›å½’æ¨¡å‹
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch11/exercise11_2.RData?raw=True")
fit<-lm(åŸæ²¹äº§é‡~å¹´ä»½,data=exercise11_2)
summary(fit)
```

 åˆ†æï¼šç”±ç»“æœå¯çŸ¥ä¸€å…ƒçº¿æ€§å›å½’é¢„æµ‹æ–¹ç¨‹ä¸º$\hat{Y_t}$=-571251.54+293.90t,åˆ™å½“t=2011æ—¶ï¼Œ$\hat{Y}_t$=19781.36ã€‚
### HoltæŒ‡æ•°å¹³æ»‘æ¨¡å‹
```{r}
exercise11_2<-ts(exercise11_2,start=1990)
grainforecast<-HoltWinters(exercise11_2[,2],gamma=FALSE)
grainforecast
library(forecast)
grainforecast1<-forecast(grainforecast,h=1)
grainforecast1
```

 åˆ†æï¼šç”±ç»“æœå¯çŸ¥HoltæŒ‡æ•°å¹³æ»‘æ¨¡å‹é¢„æµ‹2011å¹´çš„åŸæ²¹äº§é‡ä¸º20309.77ã€‚

### ç»˜åˆ¶æ®‹å·®å›¾å¯¹ä¸¤ç§æ–¹æ³•çš„é¢„æµ‹æ•ˆæœè¿›è¡Œæ¯”è¾ƒ
```{r, fig.height = 4, fig.width = 4}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch11/exercise11_2.RData?raw=True")
predata<-predict(fit,data.frame(å¹´ä»½=1990:2010)); predata#å„å¹´çš„é¢„æµ‹å€¼
res<-residuals(fit);res#å„å¹´çš„é¢„æµ‹æ®‹å·®
residual1<-grainforecast1$residuals
fit<-lm(åŸæ²¹äº§é‡~å¹´ä»½,data=exercise11_2)
residual2<-fit$residuals
#par(mai=c(0.4,0.7,0.1,0.1),cex=0.8)
plot(as.numeric(residual1),ylim=c(-800,800),xlab="",ylab="æ®‹å·®",pch=1)
points(residual2,pch=2,col="red")
abline(h=0)
legend(x="topright",legend=c("Holtæ¨¡å‹é¢„æµ‹çš„æ®‹å·®","ä¸€å…ƒçº¿æ€§å›å½’é¢„æµ‹çš„æ®‹å·®"),pch=1:2,col=c("black","red"),cex=.8)
```


  åˆ†æï¼šä»æ®‹å·®å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œä¸€å…ƒçº¿æ€§å›å½’é¢„æµ‹çš„æ®‹å·®å’ŒHoltæ¨¡å‹é¢„æµ‹çš„æ®‹å·®ç›¸å·®ä¸å¤§ï¼Œæ‰€ä»¥é€‰æ‹©ä»»æ„ä¸€ä¸ªæ¨¡å‹é¢„æµ‹å‡å¯ã€‚


## ä¸‹è¡¨æ˜¯1991-2008å¹´æˆ‘å›½è´¢æ”¿æ”¶å…¥æ•°æ®ï¼š
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch11/exercise11_3.RData?raw=True")
exercise11_3
```

### åˆ†åˆ«é‡‡ç”¨HoltæŒ‡æ•°å¹³æ»‘æ¨¡å‹å’ŒæŒ‡æ•°æ¨¡å‹é¢„æµ‹2009å¹´çš„è´¢æ”¿æ”¶å…¥ï¼Œå¹¶å¯¹å®é™…å€¼å’Œé¢„æµ‹å€¼ç»˜å›¾è¿›è¡Œæ¯”è¾ƒ
```{r, fig.height = 3, fig.width = 4}
exercise11_3<-ts(exercise11_3,start=1991)
forecast<-HoltWinters(exercise11_3[,2],gamma=FALSE)
forecast
library(forecast)
forecast1<-forecast(grainforecast,h=1)
forecast1
par(mai=c(.7,.7,.1,.1),cex=.9)
plot(forecast1,type='o',xlab="å¹´ä»½",ylab="è´¢æ”¿æ”¶å…¥" ,main="")
```


 Point Forecast    Lo 80    Hi 80    Lo 95    Hi 95
 3167.48       71943.02 69907.34 73978.69 68829.72 75056.32
 åˆ†æï¼šé‡‡ç”¨HoltæŒ‡æ•°å¹³æ»‘æ¨¡å‹é¢„æµ‹2009å¹´çš„è´¢æ”¿æ”¶å…¥ä¸º71943.02ã€‚
```{r, fig.height = 3, fig.width = 4}
exercise11_3<-ts(exercise11_3,start=1991)
forecast<-HoltWinters(exercise11_3[,2],beta=FALSE,gamma=FALSE)
forecast
library(forecast)
forecast1<-forecast(cpiforecast,h=1)
forecast1
plot(forecast1,type='o',xlab="å¹´ä»½",ylab="è´¢æ”¿æ”¶å…¥" ,main="")
```


 Point Forecast    Lo 80    Hi 80    Lo 95    Hi 95


 3167.48       61329.89 56850.69 65809.09 54479.55 68180.23

 åˆ†æï¼šé‡‡ç”¨æŒ‡æ•°æ¨¡å‹é¢„æµ‹2009å¹´çš„è´¢æ”¿æ”¶å…¥ä¸º61329.89ã€‚

## ä¸‹é¢æ˜¯æŸæ”¯è‚¡ç¥¨è¿ç»­35ä¸ªäº¤æ˜“æ—¥çš„æ”¶ç›˜ä»·æ ¼ï¼šåˆ†åˆ«æ‹Ÿåˆå›å½’ç›´çº¿äºŒæ¬¡æ›²çº¿å’Œä¸‰æ¬¡æ›²çº¿ï¼Œå¹¶ç»˜åˆ¶å›¾åƒå¯¹ç»“æœè¿›è¡Œæ¯”è¾ƒ
```{r,fig.height = 4, fig.width = 4}
library(repmis)
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch11/exercise11_4.RData?raw=True")
head(exercise11_4,10)
fit=lm(ç›˜ä»·æ ¼~æ—¶é—´,data=exercise11_4)  
summary(fit)
predata<-predict(fit,data.frame(æ—¶é—´=1:35)); predata
y<-exercise11_4[,2]
x<-1:35
fit1<-lm(y~x+I(x^2))
fit1
predata1<-predict(fit1,data.frame(x=1:35))
predata1
fit2<-lm(y~x+I(x^2)+I(x^3));fit2
predata2<-predict(fit2,data.frame(x=1:35))
predata2
residual2<-fit2$residuals
residual2
par(mfrow=c(2,2),mai=c(.6,.6,.4,.1),cex=.5)
plot(1:35,predata,type='o',lty=2,col="blue",xlab="æ—¶é—´",ylab="æ”¶ç›˜ä»·æ ¼")
lines(exercise11_4[,1],exercise11_4[,2],type='o',pch=19)
legend(x="topright",legend=c("è§‚æµ‹å€¼","é¢„æµ‹å€¼"),lty=1:5,cex=.7)
plot(1:35,predata1,type='o',lty=2,col="blue",xlab="æ—¶é—´",ylab="æ”¶ç›˜ä»·æ ¼")
lines(exercise11_4[,1],exercise11_4[,2],type='o',pch=19)
legend(x="topright",legend=c("è§‚æµ‹å€¼","é¢„æµ‹å€¼"),lty=1:5,cex=.7)
plot(1:35,predata2,type='o',lty=2,col="blue",xlab="æ—¶é—´",ylab="æ”¶ç›˜ä»·æ ¼")
lines(exercise11_4[,1],exercise11_4[,2],type='o',pch=19)
legend(x="topright",legend=c("è§‚æµ‹å€¼","é¢„æµ‹å€¼"),lty=1:5,cex=.7)
```

 åˆ†æ:ç”±å›¾å¯ä»¥çœ‹å‡ºä¸‰æ¬¡æ›²çº¿æ‹Ÿåˆæ•ˆæœæœ€å¥½


## ä¸‹è¡¨æ˜¯2009-2013å¹´æˆ‘å›½ç¤¾ä¼šæ¶ˆè´¹å“é›¶å”®æ€»é¢
### åˆ†åˆ«é‡‡ç”¨WinteræŒ‡æ•°å¹³æ»‘æ¨¡å‹å’Œåˆ†è§£æ³•é¢„æµ‹2014å¹´å„æœˆä»½çš„ç¤¾ä¼šæ¶ˆè´¹å“æ€»é¢ï¼Œå¹¶å¯¹å®é™…å€¼å’Œé¢„æµ‹å€¼ç»˜å›¾ï¼Œåˆ†æé¢„æµ‹æ•ˆæœ
```{r, fig.height = 3, fig.width = 4}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch11/exercise11_5.RData?raw=True")
exercise11_5<-ts(exercise11_5[,3],start=2009,frequency=12)
exercise11_5
saleforecast<-HoltWinters(exercise11_5)
saleforecast
library(forecast)
saleforecast1<-forecast(saleforecast,h=12)
saleforecast1
plot(saleforecast1,type='o',xlab="æ—¶é—´",ylab="é”€å”®é‡" ,main="")
```


 åˆ†æï¼šé‡‡ç”¨WinteræŒ‡æ•°å¹³æ»‘æ¨¡å‹é¢„æµ‹2014å¹´å„æœˆä»½çš„ç¤¾ä¼šæ¶ˆè´¹å“æ€»é¢ç»“æœå¦‚ä¸‹ï¼š
 Point         Forecast 
 
Jan 2014       22503.39 

Feb 2014       21508.05 

Mar 2014       21216.85 

Apr 2014       21302.16 

May 2014       22468.82 


## åˆ©ç”¨ä¹ é¢˜11.4çš„æ•°æ®åˆ†åˆ«é‡‡ç”¨m=5å’Œm=10å¯¹æ”¶ç›˜ä»·æ ¼è¿›è¡Œå¹³æ»‘ï¼Œå¹¶ç»˜åˆ¶å‡ºå®é™…å€¼ä¸å¹³æ»‘å€¼çš„å›¾å½¢è¿›è¡Œæ¯”è¾ƒ
```{r}
source_data("https://github.com/yanliangs/Statistics-with-R/blob/master/exercise/ch11/exercise11_4.RData?raw=True")
head(exercise11_4,10)
```
```{r, fig.height = 3, fig.width = 4}
exercise11_4=ts(exercise11_4,start=1)
library(DescTools)
m5=MoveAvg(exercise11_4[,2],order=5,align="center",endrule="keep")
m10=MoveAvg(exercise11_4[,2],order=10,align="center",endrule="keep")
data.frame("æ—¶é—´"=exercise11_4[,1],"æ”¶ç›˜ä»·æ ¼"=exercise11_4[,2],m5,m10)
par(mai=c(0.7,0.7,0.1,0.1),cex=0.8)
plot(exercise11_4[,2],type='o',xlab="æ—¶é—´",ylab="æ”¶ç›˜ä»·æ ¼")
lines(m5,type="o",lty=2,col="red")
lines(m10,type="o",lty=6,col="blue")
legend(x="topleft",legend=c("æ”¶ç›˜ä»·æ ¼","m5","m10"),lty=c(1,2,6),col=c("black","red","blue"),cex=0.8)
```

 ç»“è®ºï¼šm=10æ—¶çš„æ‹Ÿåˆåº¦è¾ƒå¥½